<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Bab 4 Analisis Intervensi pada model ARIMA | Perbandingan Smoothing, ARIMA, dan ARIMAX untuk prediksi harga minyak mentah</title>
  <meta name="description" content="Laporan Tugas Akhir MPDW (Kelompok 10)" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Bab 4 Analisis Intervensi pada model ARIMA | Perbandingan Smoothing, ARIMA, dan ARIMAX untuk prediksi harga minyak mentah" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Laporan Tugas Akhir MPDW (Kelompok 10)" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bab 4 Analisis Intervensi pada model ARIMA | Perbandingan Smoothing, ARIMA, dan ARIMAX untuk prediksi harga minyak mentah" />
  
  <meta name="twitter:description" content="Laporan Tugas Akhir MPDW (Kelompok 10)" />
  

<meta name="author" content="Adley Dityo Valentinus Putra (G14180009)" />
<meta name="author" content="Muhammad Ammar Sahab (G14190020)" />
<meta name="author" content="Putri Eka Perdanti (G14190027)" />
<meta name="author" content="Farhan Narendra Achyara (G14190050)" />
<meta name="author" content="Grashella Clara Nesa Br Ginting (G14190086)" />


<meta name="date" content="2022-04-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Laporan Tugas Akhir MPDW (Kelompok 10)</a></li>

<li class="divider"></li>
<li><a href="index.html#pendahuluan">Pendahuluan<span></span></a>
<ul>
<li><a href="index.html#struktur-penelitian">Struktur penelitian<span></span></a></li>
<li><a href="index.html#ekstraksi-data">Ekstraksi data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="praproses-dan-eksplorasi-data.html"><a href="praproses-dan-eksplorasi-data.html"><i class="fa fa-check"></i><b>1</b> Praproses dan Eksplorasi Data<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="praproses-dan-eksplorasi-data.html"><a href="praproses-dan-eksplorasi-data.html#interval-waktu-data"><i class="fa fa-check"></i><b>1.1</b> Interval waktu data<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="praproses-dan-eksplorasi-data.html"><a href="praproses-dan-eksplorasi-data.html#pola-pola-data-dan-stasioneritas"><i class="fa fa-check"></i><b>1.2</b> Pola-pola data dan stasioneritas<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="praproses-dan-eksplorasi-data.html"><a href="praproses-dan-eksplorasi-data.html#latar-belakang"><i class="fa fa-check"></i><b>1.3</b> Latar Belakang<span></span></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="praproses-dan-eksplorasi-data.html"><a href="praproses-dan-eksplorasi-data.html#harga-minyak-mentah-tahun-2009"><i class="fa fa-check"></i><b>1.3.1</b> Harga Minyak Mentah Tahun 2009<span></span></a></li>
<li class="chapter" data-level="1.3.2" data-path="praproses-dan-eksplorasi-data.html"><a href="praproses-dan-eksplorasi-data.html#arab-spring"><i class="fa fa-check"></i><b>1.3.2</b> Arab Spring<span></span></a></li>
<li class="chapter" data-level="1.3.3" data-path="praproses-dan-eksplorasi-data.html"><a href="praproses-dan-eksplorasi-data.html#shale-revolution"><i class="fa fa-check"></i><b>1.3.3</b> Shale Revolution<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="praproses-dan-eksplorasi-data.html"><a href="praproses-dan-eksplorasi-data.html#titik-titik-perubahan-struktural"><i class="fa fa-check"></i><b>1.4</b> Titik-titik perubahan struktural<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="praproses-dan-eksplorasi-data.html"><a href="praproses-dan-eksplorasi-data.html#kestastioneran"><i class="fa fa-check"></i><b>1.5</b> Kestastioneran<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="praproses-dan-eksplorasi-data-2017-2022.html"><a href="praproses-dan-eksplorasi-data-2017-2022.html"><i class="fa fa-check"></i><b>2</b> Praproses dan Eksplorasi Data (2017-2022)<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="praproses-dan-eksplorasi-data-2017-2022.html"><a href="praproses-dan-eksplorasi-data-2017-2022.html#interval-waktu-data-1"><i class="fa fa-check"></i><b>2.1</b> Interval waktu data<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="praproses-dan-eksplorasi-data-2017-2022.html"><a href="praproses-dan-eksplorasi-data-2017-2022.html#plot-data"><i class="fa fa-check"></i><b>2.2</b> Plot data<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="praproses-dan-eksplorasi-data-2017-2022.html"><a href="praproses-dan-eksplorasi-data-2017-2022.html#latar-belakang-1"><i class="fa fa-check"></i><b>2.3</b> Latar Belakang<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><i class="fa fa-check"></i><b>3</b> Optimisasi Parameter Pemulusan dengan Validasi Silang<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#metode"><i class="fa fa-check"></i><b>3.1</b> Metode<span></span></a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#validasi-silang-deret-waktu"><i class="fa fa-check"></i><b>3.1.1</b> Validasi Silang Deret Waktu<span></span></a></li>
<li class="chapter" data-level="3.1.2" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#metrik"><i class="fa fa-check"></i><b>3.1.2</b> Metrik<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#single-moving-average"><i class="fa fa-check"></i><b>3.2</b> Single Moving Average<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#validasi-silang-untuk-sma"><i class="fa fa-check"></i><b>3.3</b> Validasi silang untuk SMA<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#kesimpulan"><i class="fa fa-check"></i><b>3.3.1</b> Kesimpulan<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#dma"><i class="fa fa-check"></i><b>3.4</b> DMA<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#ses"><i class="fa fa-check"></i><b>3.5</b> SES<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#des"><i class="fa fa-check"></i><b>3.6</b> DES<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#kesimpulan-1"><i class="fa fa-check"></i><b>3.7</b> Kesimpulan<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="optimisasi-parameter-pemulusan-dengan-validasi-silang.html"><a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html#addendum-last-block"><i class="fa fa-check"></i><b>3.8</b> Addendum: Last Block<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html"><i class="fa fa-check"></i><b>4</b> Analisis Intervensi pada model ARIMA<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html#awal-covid"><i class="fa fa-check"></i><b>4.1</b> Awal COVID<span></span></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html#arima"><i class="fa fa-check"></i><b>4.1.1</b> ARIMA<span></span></a></li>
<li class="chapter" data-level="4.1.2" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html#analisis-intervensi"><i class="fa fa-check"></i><b>4.1.2</b> Analisis intervensi<span></span></a></li>
<li class="chapter" data-level="4.1.3" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html#perbandingan"><i class="fa fa-check"></i><b>4.1.3</b> Perbandingan<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html#covid-rebuilding"><i class="fa fa-check"></i><b>4.2</b> COVID rebuilding<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html#masa-sekarang"><i class="fa fa-check"></i><b>4.3</b> Masa Sekarang<span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html#arima-1"><i class="fa fa-check"></i><b>4.3.1</b> ARIMA<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html#arimax"><i class="fa fa-check"></i><b>4.3.2</b> ARIMAX<span></span></a></li>
<li class="chapter" data-level="4.3.3" data-path="analisis-intervensi-pada-model-arima.html"><a href="analisis-intervensi-pada-model-arima.html#rev-penanganan-autokorelasi"><i class="fa fa-check"></i><b>4.3.3</b> Rev: Penanganan autokorelasi<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Perbandingan Smoothing, ARIMA, dan ARIMAX untuk prediksi harga minyak mentah</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analisis-intervensi-pada-model-arima" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Bab 4</span> Analisis Intervensi pada model ARIMA<a href="analisis-intervensi-pada-model-arima.html#analisis-intervensi-pada-model-arima" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="analisis-intervensi-pada-model-arima.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb126-2"><a href="analisis-intervensi-pada-model-arima.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(TSA)</span>
<span id="cb126-3"><a href="analisis-intervensi-pada-model-arima.html#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>Akan dilakukan pemodelan di tiga periode: saat awal COVID, <em>rebuilding</em> setelah COVID pada akhir tahun 2020, dan masa sekarang</p>
<div id="awal-covid" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Awal COVID<a href="analisis-intervensi-pada-model-arima.html#awal-covid" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Secara umum metode pemulusan cukup buruk dalam meramal harga minyak saat COVID dan perang Rusia-Ukraina. Oleh karena itu, coba ambil data saat COVID terlebih dahulu. Jika dilihat dari tabel di bawah, harga minyak mulai turun pada minggu kesembilan 2020 (28 Februari 2020), dan tetap turun. Oleh karena itu, ambil dua titik data awal dari penurunan tersebut (28 Februari dan 06 Februari) untuk menandakan intervensi tersebut, lalu coba ramal titik-titik selanjutnya.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="analisis-intervensi-pada-model-arima.html#cb127-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(weeklyCrude[<span class="dv">160</span><span class="sc">:</span><span class="dv">170</span>])</span></code></pre></div>
<table>
<colgroup>
<col width="5%" />
<col width="7%" />
<col width="3%" />
<col width="4%" />
<col width="2%" />
<col width="2%" />
<col width="9%" />
<col width="15%" />
<col width="16%" />
<col width="6%" />
<col width="3%" />
<col width="6%" />
<col width="9%" />
<col width="5%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Week</th>
<th align="left">Date</th>
<th align="right">Close</th>
<th align="left">Dist</th>
<th align="right">6DW</th>
<th align="right">8DW</th>
<th align="left">2017 - Siklik</th>
<th align="left">Awal 2018 - harga naik</th>
<th align="left">Akhir 2018 - harga turun</th>
<th align="left">Pra-COVID</th>
<th align="left">COVID</th>
<th align="left">Pemulihan</th>
<th align="left">Vaksin, Varian</th>
<th align="left">2022</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2020-W04</td>
<td align="left">2020-01-24</td>
<td align="right">54.19</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="even">
<td align="left">2020-W05</td>
<td align="left">2020-01-31</td>
<td align="right">51.56</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="odd">
<td align="left">2020-W06</td>
<td align="left">2020-02-07</td>
<td align="right">50.32</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="even">
<td align="left">2020-W07</td>
<td align="left">2020-02-14</td>
<td align="right">52.05</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="odd">
<td align="left">2020-W08</td>
<td align="left">2020-02-21</td>
<td align="right">53.38</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="even">
<td align="left">2020-W09</td>
<td align="left">2020-02-28</td>
<td align="right">44.76</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="odd">
<td align="left">2020-W10</td>
<td align="left">2020-03-06</td>
<td align="right">41.28</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="even">
<td align="left">2020-W11</td>
<td align="left">2020-03-13</td>
<td align="right">31.73</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="odd">
<td align="left">2020-W12</td>
<td align="left">2020-03-20</td>
<td align="right">22.43</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="even">
<td align="left">2020-W13</td>
<td align="left">2020-03-27</td>
<td align="right">21.51</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
<tr class="odd">
<td align="left">2020-W14</td>
<td align="left">2020-04-03</td>
<td align="right">28.34</td>
<td align="left">7 days</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">Lainnya</td>
<td align="left">Lainnya</td>
</tr>
</tbody>
</table>
<div id="arima" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> ARIMA<a href="analisis-intervensi-pada-model-arima.html#arima" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ambil semua data sampai 6 Maret 2020 (observasi ke-166) sebagai data latih. Titik intervensi COVID yang diambil adalah 28 Februari (observasi ke-165).</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="analisis-intervensi-pada-model-arima.html#cb128-1" aria-hidden="true" tabindex="-1"></a>wcrude.covid<span class="ot">&lt;-</span><span class="fu">subset</span>(weeklyCrude, Date<span class="sc">&lt;=</span><span class="fu">as.Date</span>(<span class="st">&quot;2020-04-13&quot;</span>))</span>
<span id="cb128-2"><a href="analisis-intervensi-pada-model-arima.html#cb128-2" aria-hidden="true" tabindex="-1"></a>wcrude.train<span class="ot">&lt;-</span><span class="fu">subset</span>(wcrude.covid, Date<span class="sc">&lt;=</span><span class="fu">as.Date</span>(<span class="st">&quot;2020-03-06&quot;</span>))</span></code></pre></div>
<div id="cek-kestasioneran-data-dan-identifikasi" class="section level4 hasAnchor" number="4.1.1.1">
<h4><span class="header-section-number">4.1.1.1</span> Cek Kestasioneran Data dan Identifikasi<a href="analisis-intervensi-pada-model-arima.html#cek-kestasioneran-data-dan-identifikasi" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="analisis-intervensi-pada-model-arima.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(wcrude.train<span class="sc">$</span>Close,</span>
<span id="cb129-2"><a href="analisis-intervensi-pada-model-arima.html#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&quot;ACF Harga Minyak pra-COVID&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-462-1.png" width="672" /></p>
<p>Dari plot time series yang dibuat saat eksplorasi telah ditunjukkan bahwa data tidak stasioner. Plot ACF tersebut juga menunjukkan bahwa data tidak stasioner karena pola turun secara perlahan. Untuk itu perlu dilakukan differencing:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="analisis-intervensi-pada-model-arima.html#cb130-1" aria-hidden="true" tabindex="-1"></a>WCrude.covid_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">differences=</span> <span class="dv">1</span>)</span>
<span id="cb130-2"><a href="analisis-intervensi-pada-model-arima.html#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="analisis-intervensi-pada-model-arima.html#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot time series</span></span>
<span id="cb130-4"><a href="analisis-intervensi-pada-model-arima.html#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(WCrude.covid_diff,</span>
<span id="cb130-5"><a href="analisis-intervensi-pada-model-arima.html#cb130-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">&quot;First Difference Haarga Minyak pra-COVID&quot;</span>,</span>
<span id="cb130-6"><a href="analisis-intervensi-pada-model-arima.html#cb130-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-463-1.png" width="672" />
Berdasarkan hasil plot time series dapat dilihat bahwa data telah stasioner pada suatu nilai tertentu. Namun, terlihat lonjakan di akhir sebagai efek dari COVID. Untuk memastikannya maka akan dilihat plot ACF:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="analisis-intervensi-pada-model-arima.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(WCrude.covid_diff, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">&quot;Plot ACF&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-464-1.png" width="672" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="analisis-intervensi-pada-model-arima.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(WCrude.covid_diff, <span class="at">lag.max =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">&quot;Plot PACF&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-464-2.png" width="672" />
Melalui plot ACF dan PACF dapat dilihat bahwa data sudah stasioner. Plot ACF dan PACF langsung <em>cut off</em> pada lag 1.</p>
<p>Untuk memastikannya dapat dilakukan Uji Formal Augmented Dickey-Fuller Test sebagai berikut.</p>
<p>Hipotesis:
<span class="math display">\[
\begin{aligned}
H_0&amp;: \text{ Data tidak stasioner}\\
H_1&amp;: \text{ Data stasioner}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="analisis-intervensi-pada-model-arima.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ADF Test#</span></span>
<span id="cb133-2"><a href="analisis-intervensi-pada-model-arima.html#cb133-2" aria-hidden="true" tabindex="-1"></a>aTSA<span class="sc">::</span><span class="fu">adf.test</span>(WCrude.covid_diff)</span></code></pre></div>
<pre><code>## Augmented Dickey-Fuller Test 
## alternative: stationary 
##  
## Type 1: no drift no trend 
##      lag    ADF p.value
## [1,]   0 -11.57    0.01
## [2,]   1  -8.47    0.01
## [3,]   2  -6.75    0.01
## [4,]   3  -6.32    0.01
## [5,]   4  -5.18    0.01
## Type 2: with drift no trend 
##      lag    ADF p.value
## [1,]   0 -11.55    0.01
## [2,]   1  -8.45    0.01
## [3,]   2  -6.74    0.01
## [4,]   3  -6.31    0.01
## [5,]   4  -5.17    0.01
## Type 3: with drift and trend 
##      lag    ADF p.value
## [1,]   0 -11.61    0.01
## [2,]   1  -8.53    0.01
## [3,]   2  -6.81    0.01
## [4,]   3  -6.39    0.01
## [5,]   4  -5.26    0.01
## ---- 
## Note: in fact, p.value = 0.01 means p.value &lt;= 0.01</code></pre>
<p>Karena nilai P-Value = 0.01 &lt; alpha = 0.05, maka tolak H0. Artinya model tersebut stasioner.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="analisis-intervensi-pada-model-arima.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eacf</span>(WCrude.covid_diff)</span></code></pre></div>
<pre><code>## AR/MA
##   0 1 2 3 4 5 6 7 8 9 10 11 12 13
## 0 o o o o o o o o o o o  x  o  o 
## 1 x o o o o o o o o o o  o  o  o 
## 2 x o o o o o o o o o o  o  o  o 
## 3 x x x o o o o o o o o  o  o  o 
## 4 x x x o o o o o o o o  o  o  o 
## 5 o o o x o o o o o o o  o  o  o 
## 6 x o x x o o o o o o o  o  o  o 
## 7 o o o x o o o o o o o  o  o  o</code></pre>
<p>Berdasarkan plot EACF tersebut, diperoleh dugaan model lainnya yaitu ARIMA (0,1,1), ARIMA (1,1,0), ARIMA(1,1,1),dan ARIMA(1,1,2). Sehingga setelah dilakukan spesifikasi, terdapat 4 model tentatif yang dapat diuji.</p>
</div>
<div id="pendugaan-parameter" class="section level4 hasAnchor" number="4.1.1.2">
<h4><span class="header-section-number">4.1.1.2</span> Pendugaan Parameter<a href="analisis-intervensi-pada-model-arima.html#pendugaan-parameter" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="analisis-intervensi-pada-model-arima.html#cb137-1" aria-hidden="true" tabindex="-1"></a>model1.Wcrude<span class="ot">=</span><span class="fu">Arima</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span>
<span id="cb137-2"><a href="analisis-intervensi-pada-model-arima.html#cb137-2" aria-hidden="true" tabindex="-1"></a>model2.Wcrude<span class="ot">=</span><span class="fu">Arima</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span>
<span id="cb137-3"><a href="analisis-intervensi-pada-model-arima.html#cb137-3" aria-hidden="true" tabindex="-1"></a>model3.Wcrude<span class="ot">=</span><span class="fu">Arima</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span>
<span id="cb137-4"><a href="analisis-intervensi-pada-model-arima.html#cb137-4" aria-hidden="true" tabindex="-1"></a>model4.Wcrude<span class="ot">=</span><span class="fu">Arima</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span>
<span id="cb137-5"><a href="analisis-intervensi-pada-model-arima.html#cb137-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-6"><a href="analisis-intervensi-pada-model-arima.html#cb137-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb137-7"><a href="analisis-intervensi-pada-model-arima.html#cb137-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">&quot;ARIMA (0,1,1)&quot;</span>,<span class="st">&quot;ARIMA (1,1,0)&quot;</span>,<span class="st">&quot;ARIMA (1,1,1)&quot;</span>,<span class="st">&quot;ARIMA (1,1,2)&quot;</span>),</span>
<span id="cb137-8"><a href="analisis-intervensi-pada-model-arima.html#cb137-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(model1.Wcrude<span class="sc">$</span>aic,model2.Wcrude<span class="sc">$</span>aic,model3.Wcrude<span class="sc">$</span>aic,model4.Wcrude<span class="sc">$</span>aic)),</span>
<span id="cb137-9"><a href="analisis-intervensi-pada-model-arima.html#cb137-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>,<span class="st">&quot;AIC&quot;</span>)</span>
<span id="cb137-10"><a href="analisis-intervensi-pada-model-arima.html#cb137-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ARIMA (0,1,1)</td>
<td align="left">749.922888182951</td>
</tr>
<tr class="even">
<td align="left">ARIMA (1,1,0)</td>
<td align="left">750.006767863485</td>
</tr>
<tr class="odd">
<td align="left">ARIMA (1,1,1)</td>
<td align="left">748.606798472797</td>
</tr>
<tr class="even">
<td align="left">ARIMA (1,1,2)</td>
<td align="left">750.35562990366</td>
</tr>
</tbody>
</table>
<p>Model dengan AIC terkecil adalah <span class="math inline">\(ARIMA(1,1,1)\)</span>. Semua koefisiennya juga beda signifikan dari nol:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="analisis-intervensi-pada-model-arima.html#cb138-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(model3.Wcrude)</span></code></pre></div>
<pre><code>## 
## z test of coefficients:
## 
##      Estimate Std. Error z value  Pr(&gt;|z|)    
## ar1 -0.878333   0.055168 -15.921 &lt; 2.2e-16 ***
## ma1  0.965463   0.030861  31.285 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="diagnostik-dan-forecasting" class="section level4 hasAnchor" number="4.1.1.3">
<h4><span class="header-section-number">4.1.1.3</span> Diagnostik dan Forecasting<a href="analisis-intervensi-pada-model-arima.html#diagnostik-dan-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="analisis-intervensi-pada-model-arima.html#cb140-1" aria-hidden="true" tabindex="-1"></a>covArima<span class="ot">&lt;-</span><span class="fu">Arima</span>(wcrude.train<span class="sc">$</span>Close,</span>
<span id="cb140-2"><a href="analisis-intervensi-pada-model-arima.html#cb140-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb140-3"><a href="analisis-intervensi-pada-model-arima.html#cb140-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span></code></pre></div>
<p>Diagnostik model sebenarnya cukup baik:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="analisis-intervensi-pada-model-arima.html#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(covArima)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-470-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,1,1)
## Q* = 5.0142, df = 8, p-value = 0.7561
## 
## Model df: 2.   Total lags used: 10</code></pre>
<p>Tapi prediksi model tidak sesuai dengan apa yang akan terjadi. Bandingkan prediksi untuk 2 minggu saja:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="analisis-intervensi-pada-model-arima.html#cb143-1" aria-hidden="true" tabindex="-1"></a>forcdef<span class="ot">&lt;-</span><span class="fu">forecast</span>(covArima,<span class="dv">5</span>)</span>
<span id="cb143-2"><a href="analisis-intervensi-pada-model-arima.html#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="analisis-intervensi-pada-model-arima.html#cb143-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-4"><a href="analisis-intervensi-pada-model-arima.html#cb143-4" aria-hidden="true" tabindex="-1"></a>wcrude.covid[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="st">&quot;fitted.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(forcdef<span class="sc">$</span>fitted,<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">5</span>)),  </span>
<span id="cb143-5"><a href="analisis-intervensi-pada-model-arima.html#cb143-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;predicted.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">166</span>),forcdef<span class="sc">$</span>mean),</span>
<span id="cb143-6"><a href="analisis-intervensi-pada-model-arima.html#cb143-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lwr.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">166</span>),forcdef<span class="sc">$</span>lower[,<span class="dv">2</span>]),</span>
<span id="cb143-7"><a href="analisis-intervensi-pada-model-arima.html#cb143-7" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;upr.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">166</span>),forcdef<span class="sc">$</span>upper[,<span class="dv">2</span>]))]</span>
<span id="cb143-8"><a href="analisis-intervensi-pada-model-arima.html#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="analisis-intervensi-pada-model-arima.html#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="analisis-intervensi-pada-model-arima.html#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>wcrude.covid[<span class="dv">150</span><span class="sc">:</span><span class="dv">168</span>])<span class="sc">+</span></span>
<span id="cb143-11"><a href="analisis-intervensi-pada-model-arima.html#cb143-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb143-12"><a href="analisis-intervensi-pada-model-arima.html#cb143-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted.def,<span class="at">color=</span><span class="st">&quot;Fitted&quot;</span>))<span class="sc">+</span></span>
<span id="cb143-13"><a href="analisis-intervensi-pada-model-arima.html#cb143-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.def,<span class="at">color=</span><span class="st">&quot;Prediksi&quot;</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb143-14"><a href="analisis-intervensi-pada-model-arima.html#cb143-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.def,<span class="at">ymax=</span>upr.def, <span class="at">color=</span><span class="st">&quot;Prediksi&quot;</span>, <span class="at">fill=</span><span class="st">&quot;Prediksi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb143-15"><a href="analisis-intervensi-pada-model-arima.html#cb143-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb143-16"><a href="analisis-intervensi-pada-model-arima.html#cb143-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Prediksi&#39;</span>),</span>
<span id="cb143-17"><a href="analisis-intervensi-pada-model-arima.html#cb143-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, <span class="st">&#39;Prediksi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>))<span class="sc">+</span></span>
<span id="cb143-18"><a href="analisis-intervensi-pada-model-arima.html#cb143-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb143-19"><a href="analisis-intervensi-pada-model-arima.html#cb143-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Prediksi&#39;</span>),</span>
<span id="cb143-20"><a href="analisis-intervensi-pada-model-arima.html#cb143-20" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, <span class="st">&#39;Prediksi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>))<span class="sc">+</span></span>
<span id="cb143-21"><a href="analisis-intervensi-pada-model-arima.html#cb143-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-22"><a href="analisis-intervensi-pada-model-arima.html#cb143-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 17 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-471-1.png" width="672" /></p>
<p>Tentu prediksi tersebut cukup buruk.</p>
</div>
</div>
<div id="analisis-intervensi" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Analisis intervensi<a href="analisis-intervensi-pada-model-arima.html#analisis-intervensi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lakukan pemodelan ARIMAX (analisis intervensi) dengan sebuah fungsi transfer. Pada dasarnya kita akan membuat suatu peubah dummy pada 28 Februari 2020 untuk menandakan reaksi pasar terhadap COVID. Lalu akan dimodelkan dengan suatu fungsi <span class="citation">(<a href="#ref-cryer_time_2008" role="doc-biblioref">Cryer dan Chan 2008</a>)</span>:</p>
<p><span class="math display">\[
m_t=\frac{(\theta_0+\theta_1B+...+\theta_{q-1}B^{q-1})}{(1-\phi_1 B -...-\phi_p B^p)} P_t
\]</span></p>
<p>Dengan:
<span class="math display">\[
\begin{aligned}
m_t&amp;=\text{ Pengaruh intervensi (COVID) di waktu ke-t}\\
Z_t&amp;=\begin{cases}
1, &amp; t=165 \text{ (28 Februari 2020, mulai COVID)}\\
0, &amp;\text{lainnya}\\
\end{cases}\\
\end{aligned}
\]</span></p>
<p>Salah satu model paling sederhana adalah dengan <span class="math inline">\(AR(1)\)</span> - pada dasarnya model intervensi akan menjadi:</p>
<p><span class="math display">\[
\begin{aligned}
m_t&amp;=\frac{\theta_0}{(1-\phi_1 B)} P_t\\
(1-\phi_1B)m_t&amp;=\theta_0P_t\\
m_t-\phi_1m_{t-1}&amp;=\theta_0P_t\\
m_t&amp;=\theta_0P_t+\phi_1m_{t-1}
\end{aligned}
\]</span></p>
<p>Saat <span class="math inline">\(P_{t}=1\)</span>, tentu <span class="math inline">\(P_{t-1}=0\)</span>, <span class="math inline">\(m_{t-2}=0\)</span> (intervensi belum memiliki efek). Oleh karena itu dapat dilihat bahwa di waktu intervensi ke-r:</p>
<p><span class="math display">\[
\begin{aligned}
m_r&amp;=\theta_0\\
m_{r+1}&amp;=\theta_0\cdot0+\phi_1m_{r}=\phi_1\theta_0\\
m_{r+2}&amp;=\theta_0\cdot0+\phi_1m_{r+1}=\phi_1^2\theta_0\\
\end{aligned}
\]</span></p>
<p>Dan seterusnya. Saat <span class="math inline">\(\phi_1&lt;0\)</span>, fungsi ini menandakan suatu efek yang lama-kelamaan mengalami <em>decay</em>. Coba modelkan fungsi yang ada dengan metode tersebut:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="analisis-intervensi-pada-model-arima.html#cb146-1" aria-hidden="true" tabindex="-1"></a>intvmod<span class="ot">&lt;-</span><span class="fu">arimax</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb146-2"><a href="analisis-intervensi-pada-model-arima.html#cb146-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb146-3"><a href="analisis-intervensi-pada-model-arima.html#cb146-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb146-4"><a href="analisis-intervensi-pada-model-arima.html#cb146-4" aria-hidden="true" tabindex="-1"></a>intvmod</span></code></pre></div>
<pre><code>## 
## Call:
## arimax(x = wcrude.train$Close, order = c(1, 1, 1), xtransf = data.frame(COVID = 1 * 
##     (seq(nrow(wcrude.train)) == 165)), transfer = list(c(1, 0)))
## 
## Coefficients:
##           ar1     ma1  COVID-AR1  COVID-MA0
##       -0.8990  0.9625     1.5199    -7.9141
## s.e.   0.0594  0.0388     0.3160     2.2452
## 
## sigma^2 estimated as 4.819:  log likelihood = -363.99,  aic = 735.98</code></pre>
<p>Terlihat bahwa AIC model dengan intervensi lebih baik:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="analisis-intervensi-pada-model-arima.html#cb148-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb148-2"><a href="analisis-intervensi-pada-model-arima.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>),</span>
<span id="cb148-3"><a href="analisis-intervensi-pada-model-arima.html#cb148-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(covArima<span class="sc">$</span>aic,intvmod<span class="sc">$</span>aic)),</span>
<span id="cb148-4"><a href="analisis-intervensi-pada-model-arima.html#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>,<span class="st">&quot;AIC&quot;</span>)</span>
<span id="cb148-5"><a href="analisis-intervensi-pada-model-arima.html#cb148-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="left">748.606798472797</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="left">735.979604802578</td>
</tr>
</tbody>
</table>
<p>Begitu juga akurasinya:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="analisis-intervensi-pada-model-arima.html#cb149-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(covArima),<span class="fu">accuracy</span>(intvmod))</span>
<span id="cb149-2"><a href="analisis-intervensi-pada-model-arima.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>)</span>
<span id="cb149-3"><a href="analisis-intervensi-pada-model-arima.html#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="analisis-intervensi-pada-model-arima.html#cb149-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb149-5"><a href="analisis-intervensi-pada-model-arima.html#cb149-5" aria-hidden="true" tabindex="-1"></a>        compAcc,</span>
<span id="cb149-6"><a href="analisis-intervensi-pada-model-arima.html#cb149-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>T,</span>
<span id="cb149-7"><a href="analisis-intervensi-pada-model-arima.html#cb149-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span><span class="dv">4</span></span>
<span id="cb149-8"><a href="analisis-intervensi-pada-model-arima.html#cb149-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
<th align="right">MASE</th>
<th align="right">ACF1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">-0.0744</td>
<td align="right">2.2868</td>
<td align="right">1.7466</td>
<td align="right">-0.2395</td>
<td align="right">3.1249</td>
<td align="right">0.9709</td>
<td align="right">0.0328</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">-0.0054</td>
<td align="right">2.1886</td>
<td align="right">1.6826</td>
<td align="right">-0.0829</td>
<td align="right">2.9732</td>
<td align="right">0.9354</td>
<td align="right">0.0287</td>
</tr>
</tbody>
</table>
<p>Diagnostik residual juga oke. Lonjakan karena COVID tidak muncul lagi:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="analisis-intervensi-pada-model-arima.html#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(intvmod)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-475-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,1,1)
## Q* = 5.8303, df = 6, p-value = 0.4425
## 
## Model df: 4.   Total lags used: 10</code></pre>
<p>Semua koefisien juga beda signifikan dari nol:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="analisis-intervensi-pada-model-arima.html#cb152-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(intvmod)</span></code></pre></div>
<pre><code>## 
## z test of coefficients:
## 
##            Estimate Std. Error  z value  Pr(&gt;|z|)    
## ar1       -0.899033   0.059366 -15.1438 &lt; 2.2e-16 ***
## ma1        0.962464   0.038829  24.7873 &lt; 2.2e-16 ***
## COVID-AR1  1.519897   0.316047   4.8091 1.516e-06 ***
## COVID-MA0 -7.914105   2.245154  -3.5250 0.0004235 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Nampaknya di term intervensi <span class="math inline">\(AR(1)\)</span> merupakan model terbaik:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="analisis-intervensi-pada-model-arima.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arimax</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb154-2"><a href="analisis-intervensi-pada-model-arima.html#cb154-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb154-3"><a href="analisis-intervensi-pada-model-arima.html#cb154-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)))</span></code></pre></div>
<pre><code>## 
## Call:
## arimax(x = wcrude.train$Close, order = c(1, 1, 1), xtransf = data.frame(COVID = 1 * 
##     (seq(nrow(wcrude.train)) == 165)), transfer = list(c(0, 0)))
## 
## Coefficients:
##           ar1     ma1  COVID-MA0
##       -0.4994  0.6033    -2.5717
## s.e.   0.5154  0.4752     1.5625
## 
## sigma^2 estimated as 5.273:  log likelihood = -371.3,  aic = 748.6</code></pre>
<p>AIC model intervensi <span class="math inline">\(MA(0)\)</span> lebih tinggi. Model intervensi lain tidak dapat diduga dengan informasi yang ada:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="analisis-intervensi-pada-model-arima.html#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arimax</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb156-2"><a href="analisis-intervensi-pada-model-arima.html#cb156-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb156-3"><a href="analisis-intervensi-pada-model-arima.html#cb156-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## Error in optim(init[mask], armaCSS, method = &quot;BFGS&quot;, hessian = FALSE, : initial value in &#39;vmmin&#39; is not finite</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="analisis-intervensi-pada-model-arima.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arimax</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb158-2"><a href="analisis-intervensi-pada-model-arima.html#cb158-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb158-3"><a href="analisis-intervensi-pada-model-arima.html#cb158-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## Error in optim(init[mask], armaCSS, method = &quot;BFGS&quot;, hessian = FALSE, : initial value in &#39;vmmin&#39; is not finite</code></pre>
<div id="forecasting" class="section level4 hasAnchor" number="4.1.2.1">
<h4><span class="header-section-number">4.1.2.1</span> Forecasting<a href="analisis-intervensi-pada-model-arima.html#forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Forecasting model intervensi ini cukup kompleks. Dapat digunakan fungsi filter di R untuk menduga efek dari intervensi tersebut:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="analisis-intervensi-pada-model-arima.html#cb160-1" aria-hidden="true" tabindex="-1"></a>m.earlyCOV<span class="ot">&lt;-</span>stats<span class="sc">::</span><span class="fu">filter</span>(<span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train)<span class="sc">+</span><span class="dv">5</span>)<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb160-2"><a href="analisis-intervensi-pada-model-arima.html#cb160-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">filter=</span><span class="fl">1.5199</span>, <span class="st">&quot;recursive&quot;</span>)<span class="sc">*</span> <span class="sc">-</span><span class="fl">7.914</span></span>
<span id="cb160-3"><a href="analisis-intervensi-pada-model-arima.html#cb160-3" aria-hidden="true" tabindex="-1"></a>m.earlyCOV[<span class="dv">165</span><span class="sc">:</span><span class="dv">171</span>]</span></code></pre></div>
<pre><code>## [1]  -7.91400 -12.02849 -18.28210 -27.78696 -42.23341 -64.19055 -97.56322</code></pre>
<p>Ini dapat diverifikasi dengan manual:</p>
<p><span class="math display">\[
\begin{aligned}
m_r&amp;=-7.9141\\
m_{r+1}&amp;=\phi_1\theta_0=1.5199\cdot -7.9141=-12.02864059\\
m_{r+2}&amp;=\phi_1^2\theta_0=1.5199^{2}\cdot7.9141=-18.28233083\\
m_{r+3}&amp;=\phi_1^3\theta_0=1.5199^{3}\cdot7.9141=-27.78731\\
\end{aligned}
\]</span></p>
<p>Lalu, hasil dari filter akan dimasukkan sebagai regressor di fungsi Arima yang dimiliki package forecast:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="analisis-intervensi-pada-model-arima.html#cb162-1" aria-hidden="true" tabindex="-1"></a>intv.mod<span class="ot">&lt;-</span><span class="fu">Arima</span>(wcrude.train<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb162-2"><a href="analisis-intervensi-pada-model-arima.html#cb162-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">xreg=</span>m.earlyCOV[<span class="dv">1</span><span class="sc">:</span><span class="dv">166</span>])</span>
<span id="cb162-3"><a href="analisis-intervensi-pada-model-arima.html#cb162-3" aria-hidden="true" tabindex="-1"></a>intv.mod</span></code></pre></div>
<pre><code>## Series: wcrude.train$Close 
## Regression with ARIMA(1,1,1) errors 
## 
## Coefficients:
##           ar1     ma1    xreg
##       -0.8992  0.9626  1.0000
## s.e.   0.0592  0.0385  0.2538
## 
## sigma^2 = 4.908:  log likelihood = -363.99
## AIC=735.98   AICc=736.23   BIC=748.4</code></pre>
<p>Terlihat bahwa koefisien COVID sama dengan satu. Ini pertanda baik, karena pada dasarnya kita membuat spesifikasi di mana koefisien dari regressor tersebut harus satu:
<span class="math display">\[
Y_{t}=m_{t}+N_{t}= \text{ efek intervensi}+ \text{ ARIMA}
\]</span></p>
<p>Sehingga sebenarnya akan diregresikan nilai-nilai <span class="math inline">\(m_{t}\)</span> yang telah ditemukan saja. Lakukan forecast:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="analisis-intervensi-pada-model-arima.html#cb164-1" aria-hidden="true" tabindex="-1"></a>forcinv<span class="ot">&lt;-</span><span class="fu">forecast</span>(intv.mod,<span class="dv">5</span>,<span class="at">xreg=</span>m.earlyCOV[<span class="dv">167</span><span class="sc">:</span><span class="dv">171</span>])</span></code></pre></div>
</div>
</div>
<div id="perbandingan" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Perbandingan<a href="analisis-intervensi-pada-model-arima.html#perbandingan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dan plot. Awalnya, duga sebanyak 2 periode saja:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="analisis-intervensi-pada-model-arima.html#cb165-1" aria-hidden="true" tabindex="-1"></a>wcrude.covid[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="st">&quot;fitted.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(forcinv<span class="sc">$</span>fitted,<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">5</span>)),  </span>
<span id="cb165-2"><a href="analisis-intervensi-pada-model-arima.html#cb165-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;predicted.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">166</span>),forcinv<span class="sc">$</span>mean),</span>
<span id="cb165-3"><a href="analisis-intervensi-pada-model-arima.html#cb165-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lwr.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">166</span>),forcinv<span class="sc">$</span>lower[,<span class="dv">2</span>]),</span>
<span id="cb165-4"><a href="analisis-intervensi-pada-model-arima.html#cb165-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;upr.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">166</span>),forcinv<span class="sc">$</span>upper[,<span class="dv">2</span>]))]</span>
<span id="cb165-5"><a href="analisis-intervensi-pada-model-arima.html#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="analisis-intervensi-pada-model-arima.html#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>wcrude.covid[<span class="dv">150</span><span class="sc">:</span><span class="dv">168</span>])<span class="sc">+</span></span>
<span id="cb165-7"><a href="analisis-intervensi-pada-model-arima.html#cb165-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>)<span class="sc">+</span></span>
<span id="cb165-8"><a href="analisis-intervensi-pada-model-arima.html#cb165-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted.intv,<span class="at">color=</span><span class="st">&quot;Fitted&quot;</span>))<span class="sc">+</span></span>
<span id="cb165-9"><a href="analisis-intervensi-pada-model-arima.html#cb165-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.def,<span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb165-10"><a href="analisis-intervensi-pada-model-arima.html#cb165-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.def,<span class="at">ymax=</span>upr.def, <span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>, </span>
<span id="cb165-11"><a href="analisis-intervensi-pada-model-arima.html#cb165-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb165-12"><a href="analisis-intervensi-pada-model-arima.html#cb165-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.intv,<span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">size=</span><span class="dv">3</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb165-13"><a href="analisis-intervensi-pada-model-arima.html#cb165-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.intv,<span class="at">ymax=</span>upr.intv, <span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>, </span>
<span id="cb165-14"><a href="analisis-intervensi-pada-model-arima.html#cb165-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb165-15"><a href="analisis-intervensi-pada-model-arima.html#cb165-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb165-16"><a href="analisis-intervensi-pada-model-arima.html#cb165-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb165-17"><a href="analisis-intervensi-pada-model-arima.html#cb165-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb165-18"><a href="analisis-intervensi-pada-model-arima.html#cb165-18" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb165-19"><a href="analisis-intervensi-pada-model-arima.html#cb165-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb165-20"><a href="analisis-intervensi-pada-model-arima.html#cb165-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb165-21"><a href="analisis-intervensi-pada-model-arima.html#cb165-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb165-22"><a href="analisis-intervensi-pada-model-arima.html#cb165-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb165-23"><a href="analisis-intervensi-pada-model-arima.html#cb165-23" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb165-24"><a href="analisis-intervensi-pada-model-arima.html#cb165-24" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb165-25"><a href="analisis-intervensi-pada-model-arima.html#cb165-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot; &quot;</span>)<span class="sc">+</span></span>
<span id="cb165-26"><a href="analisis-intervensi-pada-model-arima.html#cb165-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot; Perbandingan Model Intervensi dan non-Intervensi terbaik&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-482-1.png" width="672" /></p>
<p>Namun, model ini tidak cocok untuk peramalan jangka panjang. Jika dilakukan peramalan dengan durasi sebulan (4 minggu), dugaan akan sangat jauh dari aktual. Fakta ini dapat dilihat dari plot:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="analisis-intervensi-pada-model-arima.html#cb166-1" aria-hidden="true" tabindex="-1"></a>wcrude.covid[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="st">&quot;fitted.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(forcinv<span class="sc">$</span>fitted,<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">5</span>)),  </span>
<span id="cb166-2"><a href="analisis-intervensi-pada-model-arima.html#cb166-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;predicted.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">166</span>),forcinv<span class="sc">$</span>mean),</span>
<span id="cb166-3"><a href="analisis-intervensi-pada-model-arima.html#cb166-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lwr.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">166</span>),forcinv<span class="sc">$</span>lower[,<span class="dv">2</span>]),</span>
<span id="cb166-4"><a href="analisis-intervensi-pada-model-arima.html#cb166-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;upr.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">166</span>),forcinv<span class="sc">$</span>upper[,<span class="dv">2</span>]))]</span>
<span id="cb166-5"><a href="analisis-intervensi-pada-model-arima.html#cb166-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-6"><a href="analisis-intervensi-pada-model-arima.html#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>wcrude.covid[<span class="dv">150</span><span class="sc">:</span><span class="dv">170</span>])<span class="sc">+</span></span>
<span id="cb166-7"><a href="analisis-intervensi-pada-model-arima.html#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>)<span class="sc">+</span></span>
<span id="cb166-8"><a href="analisis-intervensi-pada-model-arima.html#cb166-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted.intv,<span class="at">color=</span><span class="st">&quot;Fitted&quot;</span>))<span class="sc">+</span></span>
<span id="cb166-9"><a href="analisis-intervensi-pada-model-arima.html#cb166-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.def,<span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb166-10"><a href="analisis-intervensi-pada-model-arima.html#cb166-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.def,<span class="at">ymax=</span>upr.def, <span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>, </span>
<span id="cb166-11"><a href="analisis-intervensi-pada-model-arima.html#cb166-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb166-12"><a href="analisis-intervensi-pada-model-arima.html#cb166-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.intv,<span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">size=</span><span class="dv">3</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb166-13"><a href="analisis-intervensi-pada-model-arima.html#cb166-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.intv,<span class="at">ymax=</span>upr.intv, <span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>, </span>
<span id="cb166-14"><a href="analisis-intervensi-pada-model-arima.html#cb166-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb166-15"><a href="analisis-intervensi-pada-model-arima.html#cb166-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb166-16"><a href="analisis-intervensi-pada-model-arima.html#cb166-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb166-17"><a href="analisis-intervensi-pada-model-arima.html#cb166-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb166-18"><a href="analisis-intervensi-pada-model-arima.html#cb166-18" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb166-19"><a href="analisis-intervensi-pada-model-arima.html#cb166-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb166-20"><a href="analisis-intervensi-pada-model-arima.html#cb166-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb166-21"><a href="analisis-intervensi-pada-model-arima.html#cb166-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb166-22"><a href="analisis-intervensi-pada-model-arima.html#cb166-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb166-23"><a href="analisis-intervensi-pada-model-arima.html#cb166-23" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb166-24"><a href="analisis-intervensi-pada-model-arima.html#cb166-24" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb166-25"><a href="analisis-intervensi-pada-model-arima.html#cb166-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot; &quot;</span>)<span class="sc">+</span></span>
<span id="cb166-26"><a href="analisis-intervensi-pada-model-arima.html#cb166-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot; Perbandingan Model Intervensi dan non-Intervensi terbaik&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-483-1.png" width="672" /></p>
<p>Ini terjadi karena kita tidak mengetahui cerita dari intervensi tersebut secara sepenuhnya. Terakhir, bandingkan error testing, pertama untuk prediksi dua periode ke depan:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="analisis-intervensi-pada-model-arima.html#cb167-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(wcrude.covid<span class="sc">$</span>Close[<span class="dv">1</span><span class="sc">:</span><span class="dv">168</span>],</span>
<span id="cb167-2"><a href="analisis-intervensi-pada-model-arima.html#cb167-2" aria-hidden="true" tabindex="-1"></a>                        wcrude.covid<span class="sc">$</span>predicted.def[<span class="dv">1</span><span class="sc">:</span><span class="dv">168</span>]),</span>
<span id="cb167-3"><a href="analisis-intervensi-pada-model-arima.html#cb167-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(wcrude.covid<span class="sc">$</span>Close[<span class="dv">1</span><span class="sc">:</span><span class="dv">168</span>],</span>
<span id="cb167-4"><a href="analisis-intervensi-pada-model-arima.html#cb167-4" aria-hidden="true" tabindex="-1"></a>                        wcrude.covid<span class="sc">$</span>predicted.intv[<span class="dv">1</span><span class="sc">:</span><span class="dv">168</span>]))</span>
<span id="cb167-5"><a href="analisis-intervensi-pada-model-arima.html#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>)</span>
<span id="cb167-6"><a href="analisis-intervensi-pada-model-arima.html#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="analisis-intervensi-pada-model-arima.html#cb167-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb167-8"><a href="analisis-intervensi-pada-model-arima.html#cb167-8" aria-hidden="true" tabindex="-1"></a>        compAcc,</span>
<span id="cb167-9"><a href="analisis-intervensi-pada-model-arima.html#cb167-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>T,</span>
<span id="cb167-10"><a href="analisis-intervensi-pada-model-arima.html#cb167-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span><span class="dv">4</span></span>
<span id="cb167-11"><a href="analisis-intervensi-pada-model-arima.html#cb167-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">13.9157</td>
<td align="right">14.7441</td>
<td align="right">13.9157</td>
<td align="right">33.8807</td>
<td align="right">33.8807</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">2.8801</td>
<td align="right">2.8843</td>
<td align="right">2.8801</td>
<td align="right">9.9138</td>
<td align="right">9.9138</td>
</tr>
</tbody>
</table>
<p>Dan untuk lima periode ke depan:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="analisis-intervensi-pada-model-arima.html#cb168-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(wcrude.covid<span class="sc">$</span>Close,</span>
<span id="cb168-2"><a href="analisis-intervensi-pada-model-arima.html#cb168-2" aria-hidden="true" tabindex="-1"></a>                        wcrude.covid<span class="sc">$</span>predicted.def),</span>
<span id="cb168-3"><a href="analisis-intervensi-pada-model-arima.html#cb168-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(wcrude.covid<span class="sc">$</span>Close,</span>
<span id="cb168-4"><a href="analisis-intervensi-pada-model-arima.html#cb168-4" aria-hidden="true" tabindex="-1"></a>                        wcrude.covid<span class="sc">$</span>predicted.intv))</span>
<span id="cb168-5"><a href="analisis-intervensi-pada-model-arima.html#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>)</span>
<span id="cb168-6"><a href="analisis-intervensi-pada-model-arima.html#cb168-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-7"><a href="analisis-intervensi-pada-model-arima.html#cb168-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb168-8"><a href="analisis-intervensi-pada-model-arima.html#cb168-8" aria-hidden="true" tabindex="-1"></a>        compAcc,</span>
<span id="cb168-9"><a href="analisis-intervensi-pada-model-arima.html#cb168-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>T,</span>
<span id="cb168-10"><a href="analisis-intervensi-pada-model-arima.html#cb168-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span><span class="dv">4</span></span>
<span id="cb168-11"><a href="analisis-intervensi-pada-model-arima.html#cb168-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">15.6177</td>
<td align="right">16.1276</td>
<td align="right">15.6177</td>
<td align="right">38.1101</td>
<td align="right">38.1101</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">-22.4012</td>
<td align="right">35.3207</td>
<td align="right">24.7053</td>
<td align="right">84.9935</td>
<td align="right">126.4934</td>
</tr>
</tbody>
</table>
<p>Jelas bahwa secara jangka pendek (dua minggu), model dengan intervensi lebih baik daripada model tanpa intervensi. Namun, model tidak tepat digunakan untuk prediksi jauh ke depan.</p>
</div>
</div>
<div id="covid-rebuilding" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> COVID rebuilding<a href="analisis-intervensi-pada-model-arima.html#covid-rebuilding" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Analisis intervensi juga berguna untuk pemodelan data setelah efek intervensi habis, misal saat harga minyak naik kembali setelah COVID. Ambil data sampai akhir 2020:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="analisis-intervensi-pada-model-arima.html#cb169-1" aria-hidden="true" tabindex="-1"></a>wcrude.rebuild1<span class="ot">&lt;-</span><span class="fu">subset</span>(weeklyCrude,Date<span class="sc">&lt;=</span><span class="fu">as.Date</span>(<span class="st">&quot;2020-12-31&quot;</span>))</span></code></pre></div>
<p>Plot data tersebut:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="analisis-intervensi-pada-model-arima.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>wcrude.rebuild1[<span class="dv">160</span><span class="sc">:</span><span class="dv">209</span>,])<span class="sc">+</span></span>
<span id="cb170-2"><a href="analisis-intervensi-pada-model-arima.html#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.6</span>, <span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span><span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-487-1.png" width="672" /></p>
<p>Ambil data sapai Juni 2020 sebagai data latih. Secara umum, rebuilding terjadi setelah harga sangat rendah di sekitar Mei 2020, sehingga saat Juni 2020 sudah terjadi sedikit kenaikan harga minyak:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="analisis-intervensi-pada-model-arima.html#cb171-1" aria-hidden="true" tabindex="-1"></a>wcrude.train2<span class="ot">&lt;-</span><span class="fu">subset</span>(weeklyCrude,Date<span class="sc">&lt;=</span><span class="fu">as.Date</span>(<span class="st">&quot;2020-05-21&quot;</span>))</span></code></pre></div>
<p>Data tersebut jelas belum stasioner:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="analisis-intervensi-pada-model-arima.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(wcrude.train2<span class="sc">$</span>Close,</span>
<span id="cb172-2"><a href="analisis-intervensi-pada-model-arima.html#cb172-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span> <span class="st">&quot;ACF harga minyak sebelum COVID rebuilding&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-489-1.png" width="672" /></p>
<p>Maka lakukan differencing:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="analisis-intervensi-pada-model-arima.html#cb173-1" aria-hidden="true" tabindex="-1"></a>difftrainreb<span class="ot">&lt;-</span><span class="fu">diff</span>(wcrude.train2<span class="sc">$</span>Close,<span class="dv">1</span>)</span>
<span id="cb173-2"><a href="analisis-intervensi-pada-model-arima.html#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="analisis-intervensi-pada-model-arima.html#cb173-3" aria-hidden="true" tabindex="-1"></a>aTSA<span class="sc">::</span><span class="fu">adf.test</span>(difftrainreb)</span></code></pre></div>
<pre><code>## Augmented Dickey-Fuller Test 
## alternative: stationary 
##  
## Type 1: no drift no trend 
##      lag    ADF p.value
## [1,]   0 -10.73    0.01
## [2,]   1  -8.33    0.01
## [3,]   2  -6.72    0.01
## [4,]   3  -6.12    0.01
## [5,]   4  -5.16    0.01
## Type 2: with drift no trend 
##      lag    ADF p.value
## [1,]   0 -10.72    0.01
## [2,]   1  -8.32    0.01
## [3,]   2  -6.72    0.01
## [4,]   3  -6.13    0.01
## [5,]   4  -5.17    0.01
## Type 3: with drift and trend 
##      lag    ADF p.value
## [1,]   0 -10.79    0.01
## [2,]   1  -8.41    0.01
## [3,]   2  -6.81    0.01
## [4,]   3  -6.24    0.01
## [5,]   4  -5.27    0.01
## ---- 
## Note: in fact, p.value = 0.01 means p.value &lt;= 0.01</code></pre>
<p>Data sudah stasioner. Lalu identifikasi kandidat model:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="analisis-intervensi-pada-model-arima.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(difftrainreb)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-491-1.png" width="672" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="analisis-intervensi-pada-model-arima.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(difftrainreb)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-491-2.png" width="672" /></p>
<p>Baik ACF dan PACF signifikan di lag pertama lalu <em>cut off</em>. EACF:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="analisis-intervensi-pada-model-arima.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eacf</span>(difftrainreb)</span></code></pre></div>
<pre><code>## AR/MA
##   0 1 2 3 4 5 6 7 8 9 10 11 12 13
## 0 x o o o o o o o o o o  o  o  o 
## 1 o o o o o o o o o o o  o  o  o 
## 2 x o o o o o o o o o o  o  o  o 
## 3 x x o o o o o o o o o  o  o  o 
## 4 x o x x o o o o o o o  o  o  o 
## 5 x x x x x o o o o o o  o  o  o 
## 6 o o x x x o o o o o o  o  o  o 
## 7 x o x x o x o o o o o  o  o  o</code></pre>
<p>Kandidat model adalah <span class="math inline">\(ARIMA(1,1,0)\)</span>, <span class="math inline">\(ARIMA(0,1,1)\)</span>, <span class="math inline">\(ARIMA(2,1,1)\)</span>, dan <span class="math inline">\(ARIMA(1,1,1)\)</span> :</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="analisis-intervensi-pada-model-arima.html#cb179-1" aria-hidden="true" tabindex="-1"></a>rmod1<span class="ot">&lt;-</span><span class="fu">Arima</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb179-2"><a href="analisis-intervensi-pada-model-arima.html#cb179-2" aria-hidden="true" tabindex="-1"></a>rmod2<span class="ot">&lt;-</span><span class="fu">Arima</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb179-3"><a href="analisis-intervensi-pada-model-arima.html#cb179-3" aria-hidden="true" tabindex="-1"></a>rmod3<span class="ot">&lt;-</span><span class="fu">Arima</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb179-4"><a href="analisis-intervensi-pada-model-arima.html#cb179-4" aria-hidden="true" tabindex="-1"></a>rmod4<span class="ot">&lt;-</span><span class="fu">Arima</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb179-5"><a href="analisis-intervensi-pada-model-arima.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="analisis-intervensi-pada-model-arima.html#cb179-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb179-7"><a href="analisis-intervensi-pada-model-arima.html#cb179-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">&quot;ARIMA (1,1,0)&quot;</span>,<span class="st">&quot;ARIMA (0,1,1)&quot;</span>,<span class="st">&quot;ARIMA (2,1,1)&quot;</span>,<span class="st">&quot;ARIMA (1,1,1)&quot;</span>),</span>
<span id="cb179-8"><a href="analisis-intervensi-pada-model-arima.html#cb179-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(rmod1<span class="sc">$</span>aic,rmod2<span class="sc">$</span>aic,rmod3<span class="sc">$</span>aic,rmod4<span class="sc">$</span>aic)),</span>
<span id="cb179-9"><a href="analisis-intervensi-pada-model-arima.html#cb179-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>,<span class="st">&quot;AIC&quot;</span>)</span>
<span id="cb179-10"><a href="analisis-intervensi-pada-model-arima.html#cb179-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ARIMA (1,1,0)</td>
<td align="left">835.224348584948</td>
</tr>
<tr class="even">
<td align="left">ARIMA (0,1,1)</td>
<td align="left">835.105820733153</td>
</tr>
<tr class="odd">
<td align="left">ARIMA (2,1,1)</td>
<td align="left">834.243852521724</td>
</tr>
<tr class="even">
<td align="left">ARIMA (1,1,1)</td>
<td align="left">837.102045165476</td>
</tr>
</tbody>
</table>
<p>Menunjukkan bahwa Arima(2,1,1) model terbaik dengan semua koefisien signifikan di taraf <span class="math inline">\(10/%\)</span>:</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="analisis-intervensi-pada-model-arima.html#cb180-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(rmod3)</span></code></pre></div>
<pre><code>## 
## z test of coefficients:
## 
##      Estimate Std. Error z value Pr(&gt;|z|)    
## ar1 -0.748382   0.078214 -9.5684  &lt; 2e-16 ***
## ar2  0.135859   0.077041  1.7635  0.07782 .  
## ma1  0.982464   0.020786 47.2667  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Tetap saja ada lonjakan besar di residual saat COVID:</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="analisis-intervensi-pada-model-arima.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(rmod3)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-495-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(2,1,1)
## Q* = 6.5065, df = 7, p-value = 0.482
## 
## Model df: 3.   Total lags used: 10</code></pre>
<p>Intinya setelah dicoba <span class="math inline">\(ARIMA(0,1,1)\)</span> oke:</p>
<p>Tren naik kembali tidak dapat diprediksi.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="analisis-intervensi-pada-model-arima.html#cb184-1" aria-hidden="true" tabindex="-1"></a>forcdef.reb<span class="ot">&lt;-</span><span class="fu">forecast</span>(rmod3,<span class="dv">33</span>)</span>
<span id="cb184-2"><a href="analisis-intervensi-pada-model-arima.html#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="analisis-intervensi-pada-model-arima.html#cb184-3" aria-hidden="true" tabindex="-1"></a>wcrude.rebuild1[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="st">&quot;fitted.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(forcdef.reb<span class="sc">$</span>fitted,<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">33</span>)),  </span>
<span id="cb184-4"><a href="analisis-intervensi-pada-model-arima.html#cb184-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;predicted.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">176</span>),forcdef.reb<span class="sc">$</span>mean),</span>
<span id="cb184-5"><a href="analisis-intervensi-pada-model-arima.html#cb184-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lwr.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">176</span>),forcdef.reb<span class="sc">$</span>lower[,<span class="dv">2</span>]),</span>
<span id="cb184-6"><a href="analisis-intervensi-pada-model-arima.html#cb184-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;upr.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">176</span>),forcdef.reb<span class="sc">$</span>upper[,<span class="dv">2</span>]))]</span>
<span id="cb184-7"><a href="analisis-intervensi-pada-model-arima.html#cb184-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-8"><a href="analisis-intervensi-pada-model-arima.html#cb184-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-9"><a href="analisis-intervensi-pada-model-arima.html#cb184-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>wcrude.rebuild1[<span class="dv">150</span><span class="sc">:</span><span class="dv">185</span>])<span class="sc">+</span></span>
<span id="cb184-10"><a href="analisis-intervensi-pada-model-arima.html#cb184-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">&quot;gray&quot;</span>)<span class="sc">+</span></span>
<span id="cb184-11"><a href="analisis-intervensi-pada-model-arima.html#cb184-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted.def,<span class="at">color=</span><span class="st">&quot;Fitted&quot;</span>))<span class="sc">+</span></span>
<span id="cb184-12"><a href="analisis-intervensi-pada-model-arima.html#cb184-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.def,<span class="at">color=</span><span class="st">&quot;Prediksi&quot;</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb184-13"><a href="analisis-intervensi-pada-model-arima.html#cb184-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.def,<span class="at">ymax=</span>upr.def, <span class="at">color=</span><span class="st">&quot;Prediksi&quot;</span>, <span class="at">fill=</span><span class="st">&quot;Prediksi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb184-14"><a href="analisis-intervensi-pada-model-arima.html#cb184-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb184-15"><a href="analisis-intervensi-pada-model-arima.html#cb184-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Prediksi&#39;</span>),</span>
<span id="cb184-16"><a href="analisis-intervensi-pada-model-arima.html#cb184-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, <span class="st">&#39;Prediksi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>))<span class="sc">+</span></span>
<span id="cb184-17"><a href="analisis-intervensi-pada-model-arima.html#cb184-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 9 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 27 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-496-1.png" width="672" /></p>
<p>Dapat dicoba berbagai spesifikasi model arimax. Pertama akan dicobakan spesifikasi arimax sebelumnya, yaitu AR saja. Koefisien MA lalu ditingkatkan sampai 3, lalu dicobakan cara <span class="citation">(<a href="#ref-cryer_time_2008" role="doc-biblioref">Cryer dan Chan 2008</a>)</span>, yaitu membuat dua peubah untuk memisahkan efek langsung dari COVID dan efek yang secara eksponen turun. Efek langsung dimodelkan dengan MA dan efek turun dimodelkan dengan AR. Efek yang lebih kompleks untuk intervensi hanya dapat dimodelkan dengan <span class="math inline">\(ARIMA(1,1,0)\)</span> untuk kesluruhan, tetapi ini tidak apa-apa karena model tersebut sebenarnya memiliki AIC yang mendekati <span class="math inline">\(ARIMA(2,1,1)\)</span>:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="analisis-intervensi-pada-model-arima.html#cb187-1" aria-hidden="true" tabindex="-1"></a>arimaxdef<span class="ot">&lt;-</span><span class="fu">arimax</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb187-2"><a href="analisis-intervensi-pada-model-arima.html#cb187-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train2))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb187-3"><a href="analisis-intervensi-pada-model-arima.html#cb187-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb187-4"><a href="analisis-intervensi-pada-model-arima.html#cb187-4" aria-hidden="true" tabindex="-1"></a>arimaxmad1<span class="ot">&lt;-</span><span class="fu">arimax</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb187-5"><a href="analisis-intervensi-pada-model-arima.html#cb187-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train2))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb187-6"><a href="analisis-intervensi-pada-model-arima.html#cb187-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</span>
<span id="cb187-7"><a href="analisis-intervensi-pada-model-arima.html#cb187-7" aria-hidden="true" tabindex="-1"></a>arimaxmad2<span class="ot">&lt;-</span><span class="fu">arimax</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb187-8"><a href="analisis-intervensi-pada-model-arima.html#cb187-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train2))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb187-9"><a href="analisis-intervensi-pada-model-arima.html#cb187-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb187-10"><a href="analisis-intervensi-pada-model-arima.html#cb187-10" aria-hidden="true" tabindex="-1"></a>arimaxmad3<span class="ot">&lt;-</span><span class="fu">arimax</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb187-11"><a href="analisis-intervensi-pada-model-arima.html#cb187-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train2))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb187-12"><a href="analisis-intervensi-pada-model-arima.html#cb187-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)))</span>
<span id="cb187-13"><a href="analisis-intervensi-pada-model-arima.html#cb187-13" aria-hidden="true" tabindex="-1"></a>arimaxd1<span class="ot">&lt;-</span><span class="fu">arimax</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb187-14"><a href="analisis-intervensi-pada-model-arima.html#cb187-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train2))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb187-15"><a href="analisis-intervensi-pada-model-arima.html#cb187-15" aria-hidden="true" tabindex="-1"></a>                          <span class="at">COVIDb=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train2))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb187-16"><a href="analisis-intervensi-pada-model-arima.html#cb187-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb187-17"><a href="analisis-intervensi-pada-model-arima.html#cb187-17" aria-hidden="true" tabindex="-1"></a>arimaxd2<span class="ot">&lt;-</span><span class="fu">arimax</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb187-18"><a href="analisis-intervensi-pada-model-arima.html#cb187-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train2))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb187-19"><a href="analisis-intervensi-pada-model-arima.html#cb187-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">COVIDb=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.train2))<span class="sc">==</span><span class="dv">165</span>)),</span>
<span id="cb187-20"><a href="analisis-intervensi-pada-model-arima.html#cb187-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)))</span></code></pre></div>
<p>Bandingkan AIC tiap spesifikasi model tersebut:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="analisis-intervensi-pada-model-arima.html#cb188-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kables</span>(<span class="fu">list</span>(</span>
<span id="cb188-2"><a href="analisis-intervensi-pada-model-arima.html#cb188-2" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(arimaxdef<span class="sc">$</span>aic,<span class="at">col.names=</span><span class="st">&quot;Intervensi AR(1)&quot;</span>),</span>
<span id="cb188-3"><a href="analisis-intervensi-pada-model-arima.html#cb188-3" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(arimaxmad1<span class="sc">$</span>aic,arimaxmad2<span class="sc">$</span>aic,arimaxmad3<span class="sc">$</span>aic),</span>
<span id="cb188-4"><a href="analisis-intervensi-pada-model-arima.html#cb188-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&quot;ARMA(1,1)&quot;</span>,<span class="st">&quot;ARMA(1,2)&quot;</span>,<span class="st">&quot;MA(1,3)&quot;</span>)),</span>
<span id="cb188-5"><a href="analisis-intervensi-pada-model-arima.html#cb188-5" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(arimaxd1<span class="sc">$</span>aic,arimaxd2<span class="sc">$</span>aic),<span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&quot;MA(1)+AR(1)&quot;</span>,<span class="st">&quot;MA(2)+AR(1)&quot;</span>))</span>
<span id="cb188-6"><a href="analisis-intervensi-pada-model-arima.html#cb188-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb188-7"><a href="analisis-intervensi-pada-model-arima.html#cb188-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table class="kable_wrapper">
<tbody>
<tr>
<td>
<table>
<thead>
<tr class="header">
<th align="right">Intervensi AR(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">829.1429</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">ARMA(1,1)</th>
<th align="right">ARMA(1,2)</th>
<th align="right">MA(1,3)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">829.9415</td>
<td align="right">827.1838</td>
<td align="right">794.4952</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr class="header">
<th align="right">MA(1)+AR(1)</th>
<th align="right">MA(2)+AR(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">816.3303</td>
<td align="right">798.1868</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<p>Sehingga model terbaik adalah:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="analisis-intervensi-pada-model-arima.html#cb189-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(arimaxmad3)</span></code></pre></div>
<pre><code>## 
## z test of coefficients:
## 
##             Estimate Std. Error z value  Pr(&gt;|z|)    
## ar1         0.085736   0.076698  1.1178 0.2636356    
## COVID-AR1   0.960466   0.024310 39.5084 &lt; 2.2e-16 ***
## COVID-MA0  -8.471105   2.348759 -3.6066 0.0003102 ***
## COVID-MA1  -4.447146   2.369339 -1.8770 0.0605241 .  
## COVID-MA2 -10.611313   2.375934 -4.4662 7.963e-06 ***
## COVID-MA3 -10.643718   2.382815 -4.4669 7.937e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Terlihat bahwa semua koefisien lebih besar dari galat baku, sehingga kemungkinan signifikan.Signifikansi koefisien <span class="math inline">\(AR(1)\)</span> cukup <em>worrying</em>, tetapi probabilitas koefisien tersebut muncul jika koefisiennya sebenarnya nol masih sekitar <span class="math inline">\(26/%\)</span>. Residual kedua model tampak oke:</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="analisis-intervensi-pada-model-arima.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(arimaxmad3)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-500-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,1,0)
## Q* = 5.5843, df = 4, p-value = 0.2324
## 
## Model df: 6.   Total lags used: 10</code></pre>
<p>Perhatikan spesifikasi model tersebut secara matematis:</p>
<p><span class="math display">\[
\begin{aligned}
m_t&amp;=\frac{(\theta_0+\theta_1B+\theta_2B^2+\theta_3B^3)}{(1-\phi_1 B)} P_t\\
(1-\phi_1B)m_t&amp;=\theta_0P_t+\theta_1P_{t-1}+\theta_2P_{t-2}+\theta_3P_{t-3}\\
m_t-\phi_1m_{t-1}&amp;=\theta_0P_t+\theta_1P_{t-1}+\theta_2P_{t-2}+\theta_3P_{t-3}\\
m_t&amp;=\theta_0P_t+\theta_1P_{t-1}+\theta_2P_{t-2}+\theta_3P_{t-3}+\phi_1m_{t-1}\\
\end{aligned}
\]</span></p>
<p>Sama seperti sebelumnya, untuk forecasting nilai tersebut dapat dicari dengan fungsi filter:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="analisis-intervensi-pada-model-arima.html#cb193-1" aria-hidden="true" tabindex="-1"></a>COVID<span class="ot">=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(wcrude.rebuild1))<span class="sc">==</span><span class="dv">165</span>)</span>
<span id="cb193-2"><a href="analisis-intervensi-pada-model-arima.html#cb193-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-3"><a href="analisis-intervensi-pada-model-arima.html#cb193-3" aria-hidden="true" tabindex="-1"></a>tss<span class="ot">&lt;-</span>stats<span class="sc">::</span><span class="fu">filter</span>(COVID,<span class="fu">c</span>(<span class="sc">-</span><span class="fl">8.471105</span>,    <span class="sc">-</span><span class="fl">4.447146</span>,   <span class="sc">-</span><span class="fl">10.611313</span>,   <span class="sc">-</span><span class="fl">10.643718</span>),<span class="st">&quot;convolution&quot;</span>,<span class="at">sides=</span><span class="dv">1</span>)</span>
<span id="cb193-4"><a href="analisis-intervensi-pada-model-arima.html#cb193-4" aria-hidden="true" tabindex="-1"></a>tss[<span class="fu">is.na</span>(tss)]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb193-5"><a href="analisis-intervensi-pada-model-arima.html#cb193-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-6"><a href="analisis-intervensi-pada-model-arima.html#cb193-6" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span>stats<span class="sc">::</span><span class="fu">filter</span>(tss,<span class="fl">0.960466</span>,<span class="st">&quot;recursive&quot;</span>,<span class="at">sides=</span><span class="dv">1</span>)</span>
<span id="cb193-7"><a href="analisis-intervensi-pada-model-arima.html#cb193-7" aria-hidden="true" tabindex="-1"></a>m[<span class="dv">165</span><span class="sc">:</span><span class="dv">209</span>]</span></code></pre></div>
<pre><code>##  [1]  -8.471105 -12.583354 -22.697197 -32.443604 -31.160979 -29.929060 -28.745845 -27.609407
##  [9] -26.517896 -25.469538 -24.462625 -23.495520 -22.566648 -21.674498 -20.817618 -19.994615
## [17] -19.204148 -18.444931 -17.715729 -17.015355 -16.342670 -15.696579 -15.076031 -14.480015
## [25] -13.907562 -13.357740 -12.829655 -12.322448 -11.835292 -11.367396 -10.917997 -10.486365
## [33] -10.071797  -9.673619  -9.291182  -8.923864  -8.571068  -8.232220  -7.906767  -7.594181
## [41]  -7.293953  -7.005593  -6.728634  -6.462624  -6.207131</code></pre>
<p>Empat hasil hitungan pertama mirip dengan hitungan manual. Selanjutnya dapat dengan mudah diverifikasi dengan mengalikan dengan pangkat dari <span class="math inline">\(\phi_1\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
m_{r}&amp;=\theta_0&amp;&amp;=-8.4711    \\
m_{r+1}&amp;=\theta_1+\phi_1\theta_0&amp;=-4.4471+0.9605    \cdot -8.4711&amp;=12.5835\\
m_{r+2}&amp;=\theta_2+\phi_1m_{r+1}=\theta_2+\phi_1\theta_1+\phi_1^2\theta_0&amp;=-10.6113+0.9605\cdot12.5835&amp;=22.69775175\\
m_{r+3}&amp;=\theta_3+\phi_1m_{r+2}=\theta_3+\phi_1\theta_2+\phi_1^2\theta_1+\phi_1^3\theta_0&amp;=-10.6437+0.9605\cdot22.69775175&amp;=32.44489057\\
m_{r+k}&amp;=\phi_1^{k-3}m_{r+k-1}=\phi_1^{k-3}\theta_3+\phi_1^{k-2}\theta_2+\phi_1^{k-1}\theta_1+\phi_1^k\theta_0\\
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="analisis-intervensi-pada-model-arima.html#cb195-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.9605</span><span class="sc">^</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>))<span class="sc">*-</span><span class="fl">32.44489057</span></span></code></pre></div>
<pre><code>##  [1] -31.16332 -29.93237 -28.75004 -27.61441 -26.52364 -25.47596 -24.46966 -23.50311 -22.57473
## [10] -21.68303 -20.82655 -20.00390 -19.21375 -18.45481 -17.72584 -17.02567 -16.35316 -15.70721
## [19] -15.08677 -14.49084</code></pre>
<p>Gunakan fungsi Arima lalu prediksi:</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="analisis-intervensi-pada-model-arima.html#cb197-1" aria-hidden="true" tabindex="-1"></a>rebuildModfin<span class="ot">&lt;-</span><span class="fu">Arima</span>(wcrude.train2<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb197-2"><a href="analisis-intervensi-pada-model-arima.html#cb197-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xreg=</span>m[<span class="dv">1</span><span class="sc">:</span><span class="dv">176</span>])</span>
<span id="cb197-3"><a href="analisis-intervensi-pada-model-arima.html#cb197-3" aria-hidden="true" tabindex="-1"></a>rebuildModfin</span></code></pre></div>
<pre><code>## Series: wcrude.train2$Close 
## Regression with ARIMA(1,1,0) errors 
## 
## Coefficients:
##          ar1    xreg
##       0.0850  0.9505
## s.e.  0.0758  0.1424
## 
## sigma^2 = 5.519:  log likelihood = -396.78
## AIC=799.57   AICc=799.71   BIC=809.06</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="analisis-intervensi-pada-model-arima.html#cb199-1" aria-hidden="true" tabindex="-1"></a>forc.inv.reb<span class="ot">&lt;-</span><span class="fu">forecast</span>(rebuildModfin,<span class="dv">33</span>,<span class="at">xreg=</span>m[<span class="dv">177</span><span class="sc">:</span><span class="dv">209</span>])</span></code></pre></div>
<p>Dalam periode sama, dapat dilihat bahwa prediksi model ARIMAX lebih baik:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="analisis-intervensi-pada-model-arima.html#cb200-1" aria-hidden="true" tabindex="-1"></a>wcrude.rebuild1[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="st">&quot;fitted.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(forc.inv.reb<span class="sc">$</span>fitted,<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">33</span>)),  </span>
<span id="cb200-2"><a href="analisis-intervensi-pada-model-arima.html#cb200-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;predicted.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">176</span>),forc.inv.reb<span class="sc">$</span>mean),</span>
<span id="cb200-3"><a href="analisis-intervensi-pada-model-arima.html#cb200-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lwr.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">176</span>),forc.inv.reb<span class="sc">$</span>lower[,<span class="dv">2</span>]),</span>
<span id="cb200-4"><a href="analisis-intervensi-pada-model-arima.html#cb200-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;upr.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">176</span>),forc.inv.reb<span class="sc">$</span>upper[,<span class="dv">2</span>]))]</span>
<span id="cb200-5"><a href="analisis-intervensi-pada-model-arima.html#cb200-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-6"><a href="analisis-intervensi-pada-model-arima.html#cb200-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>wcrude.rebuild1[<span class="dv">150</span><span class="sc">:</span><span class="dv">185</span>])<span class="sc">+</span></span>
<span id="cb200-7"><a href="analisis-intervensi-pada-model-arima.html#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>)<span class="sc">+</span></span>
<span id="cb200-8"><a href="analisis-intervensi-pada-model-arima.html#cb200-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted.intv,<span class="at">color=</span><span class="st">&quot;Fitted&quot;</span>))<span class="sc">+</span></span>
<span id="cb200-9"><a href="analisis-intervensi-pada-model-arima.html#cb200-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.def,<span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb200-10"><a href="analisis-intervensi-pada-model-arima.html#cb200-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.def,<span class="at">ymax=</span>upr.def, <span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>, </span>
<span id="cb200-11"><a href="analisis-intervensi-pada-model-arima.html#cb200-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb200-12"><a href="analisis-intervensi-pada-model-arima.html#cb200-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.intv,<span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">size=</span><span class="dv">3</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb200-13"><a href="analisis-intervensi-pada-model-arima.html#cb200-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.intv,<span class="at">ymax=</span>upr.intv, <span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>, </span>
<span id="cb200-14"><a href="analisis-intervensi-pada-model-arima.html#cb200-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb200-15"><a href="analisis-intervensi-pada-model-arima.html#cb200-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb200-16"><a href="analisis-intervensi-pada-model-arima.html#cb200-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb200-17"><a href="analisis-intervensi-pada-model-arima.html#cb200-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb200-18"><a href="analisis-intervensi-pada-model-arima.html#cb200-18" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb200-19"><a href="analisis-intervensi-pada-model-arima.html#cb200-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb200-20"><a href="analisis-intervensi-pada-model-arima.html#cb200-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb200-21"><a href="analisis-intervensi-pada-model-arima.html#cb200-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb200-22"><a href="analisis-intervensi-pada-model-arima.html#cb200-22" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb200-23"><a href="analisis-intervensi-pada-model-arima.html#cb200-23" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb200-24"><a href="analisis-intervensi-pada-model-arima.html#cb200-24" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb200-25"><a href="analisis-intervensi-pada-model-arima.html#cb200-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot; &quot;</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot; Perbandingan Model Intervensi dan non-Intervensi terbaik&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-504-1.png" width="672" /></p>
<p>Bahkan, jika diekspansi sampai akhir 2020, prediksi masih baik.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="analisis-intervensi-pada-model-arima.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>wcrude.rebuild1[<span class="dv">150</span><span class="sc">:</span><span class="dv">209</span>])<span class="sc">+</span></span>
<span id="cb201-2"><a href="analisis-intervensi-pada-model-arima.html#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>)<span class="sc">+</span></span>
<span id="cb201-3"><a href="analisis-intervensi-pada-model-arima.html#cb201-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted.intv,<span class="at">color=</span><span class="st">&quot;Fitted&quot;</span>))<span class="sc">+</span></span>
<span id="cb201-4"><a href="analisis-intervensi-pada-model-arima.html#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.def,<span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb201-5"><a href="analisis-intervensi-pada-model-arima.html#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.def,<span class="at">ymax=</span>upr.def, <span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>, </span>
<span id="cb201-6"><a href="analisis-intervensi-pada-model-arima.html#cb201-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb201-7"><a href="analisis-intervensi-pada-model-arima.html#cb201-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.intv,<span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">size=</span><span class="dv">3</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb201-8"><a href="analisis-intervensi-pada-model-arima.html#cb201-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.intv,<span class="at">ymax=</span>upr.intv, <span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>, </span>
<span id="cb201-9"><a href="analisis-intervensi-pada-model-arima.html#cb201-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb201-10"><a href="analisis-intervensi-pada-model-arima.html#cb201-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb201-11"><a href="analisis-intervensi-pada-model-arima.html#cb201-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb201-12"><a href="analisis-intervensi-pada-model-arima.html#cb201-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb201-13"><a href="analisis-intervensi-pada-model-arima.html#cb201-13" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb201-14"><a href="analisis-intervensi-pada-model-arima.html#cb201-14" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb201-15"><a href="analisis-intervensi-pada-model-arima.html#cb201-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb201-16"><a href="analisis-intervensi-pada-model-arima.html#cb201-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb201-17"><a href="analisis-intervensi-pada-model-arima.html#cb201-17" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb201-18"><a href="analisis-intervensi-pada-model-arima.html#cb201-18" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb201-19"><a href="analisis-intervensi-pada-model-arima.html#cb201-19" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb201-20"><a href="analisis-intervensi-pada-model-arima.html#cb201-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot; &quot;</span>)<span class="sc">+</span></span>
<span id="cb201-21"><a href="analisis-intervensi-pada-model-arima.html#cb201-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot; Perbandingan Model Intervensi dan non-Intervensi terbaik&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-505-1.png" width="672" /></p>
<p>Dapat dibandingkan akurasi di training:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="analisis-intervensi-pada-model-arima.html#cb202-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(rmod3),<span class="fu">accuracy</span>(arimaxmad3))</span>
<span id="cb202-2"><a href="analisis-intervensi-pada-model-arima.html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>)</span>
<span id="cb202-3"><a href="analisis-intervensi-pada-model-arima.html#cb202-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(compAcc,<span class="at">row.names=</span>T,<span class="at">digits =</span><span class="dv">4</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
<th align="right">MASE</th>
<th align="right">ACF1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">-0.1080</td>
<td align="right">2.5517</td>
<td align="right">1.9351</td>
<td align="right">-0.4137</td>
<td align="right">4.0592</td>
<td align="right">0.9751</td>
<td align="right">-0.0061</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">0.0008</td>
<td align="right">2.3463</td>
<td align="right">1.8217</td>
<td align="right">-0.1753</td>
<td align="right">3.7110</td>
<td align="right">0.9179</td>
<td align="right">0.0016</td>
</tr>
</tbody>
</table>
<p>Peramalan 9 periode:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="analisis-intervensi-pada-model-arima.html#cb203-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="fl">.1</span><span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(wcrude.rebuild1<span class="sc">$</span>Close[<span class="dv">1</span><span class="sc">:</span><span class="dv">185</span>],</span>
<span id="cb203-2"><a href="analisis-intervensi-pada-model-arima.html#cb203-2" aria-hidden="true" tabindex="-1"></a>                          wcrude.rebuild1<span class="sc">$</span>predicted.def[<span class="dv">1</span><span class="sc">:</span><span class="dv">185</span>]),</span>
<span id="cb203-3"><a href="analisis-intervensi-pada-model-arima.html#cb203-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">accuracy</span>(wcrude.rebuild1<span class="sc">$</span>Close[<span class="dv">1</span><span class="sc">:</span><span class="dv">185</span>],</span>
<span id="cb203-4"><a href="analisis-intervensi-pada-model-arima.html#cb203-4" aria-hidden="true" tabindex="-1"></a>                          wcrude.rebuild1<span class="sc">$</span>predicted.intv[<span class="dv">1</span><span class="sc">:</span><span class="dv">185</span>]))</span>
<span id="cb203-5"><a href="analisis-intervensi-pada-model-arima.html#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc<span class="fl">.1</span>)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>)</span>
<span id="cb203-6"><a href="analisis-intervensi-pada-model-arima.html#cb203-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-7"><a href="analisis-intervensi-pada-model-arima.html#cb203-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(compAcc<span class="fl">.1</span>,<span class="at">row.names=</span>T,<span class="at">digits =</span><span class="dv">4</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">-7.7723</td>
<td align="right">8.1563</td>
<td align="right">7.7723</td>
<td align="right">-25.4596</td>
<td align="right">25.4596</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">-4.5300</td>
<td align="right">4.7263</td>
<td align="right">4.5300</td>
<td align="right">-13.4199</td>
<td align="right">13.4199</td>
</tr>
</tbody>
</table>
<p>Peramalan 33 periode:</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="analisis-intervensi-pada-model-arima.html#cb204-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="fl">.2</span><span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(wcrude.rebuild1<span class="sc">$</span>Close[<span class="dv">1</span><span class="sc">:</span><span class="dv">209</span>],</span>
<span id="cb204-2"><a href="analisis-intervensi-pada-model-arima.html#cb204-2" aria-hidden="true" tabindex="-1"></a>                          wcrude.rebuild1<span class="sc">$</span>predicted.def[<span class="dv">1</span><span class="sc">:</span><span class="dv">209</span>]),</span>
<span id="cb204-3"><a href="analisis-intervensi-pada-model-arima.html#cb204-3" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">accuracy</span>(wcrude.rebuild1<span class="sc">$</span>Close[<span class="dv">1</span><span class="sc">:</span><span class="dv">209</span>],</span>
<span id="cb204-4"><a href="analisis-intervensi-pada-model-arima.html#cb204-4" aria-hidden="true" tabindex="-1"></a>                          wcrude.rebuild1<span class="sc">$</span>predicted.intv[<span class="dv">1</span><span class="sc">:</span><span class="dv">209</span>]))</span>
<span id="cb204-5"><a href="analisis-intervensi-pada-model-arima.html#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc<span class="fl">.2</span>)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>)</span>
<span id="cb204-6"><a href="analisis-intervensi-pada-model-arima.html#cb204-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb204-7"><a href="analisis-intervensi-pada-model-arima.html#cb204-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(compAcc<span class="fl">.1</span>,<span class="at">row.names=</span>T,<span class="at">digits =</span><span class="dv">4</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">-7.7723</td>
<td align="right">8.1563</td>
<td align="right">7.7723</td>
<td align="right">-25.4596</td>
<td align="right">25.4596</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">-4.5300</td>
<td align="right">4.7263</td>
<td align="right">4.5300</td>
<td align="right">-13.4199</td>
<td align="right">13.4199</td>
</tr>
</tbody>
</table>
<p>Model dengan intervensi umumnya lebih baik.</p>
</div>
<div id="masa-sekarang" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Masa Sekarang<a href="analisis-intervensi-pada-model-arima.html#masa-sekarang" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Perang Ukraina Rusia dimulai di Februari 24, 2020. Ambil data ke 269 dan 270 (awal Maret), lalu prediksi harga minyak sampai akhir.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="analisis-intervensi-pada-model-arima.html#cb205-1" aria-hidden="true" tabindex="-1"></a>weeklyCrude[<span class="dv">269</span><span class="sc">:</span><span class="dv">277</span>]</span></code></pre></div>
<pre><code>##        Week       Date  Close   Dist 6DW 8DW 2017 - Siklik Awal 2018 - harga naik
## 1: 2022-W08 2022-02-25  91.59 7 days   0   0         FALSE                  FALSE
## 2: 2022-W09 2022-03-04 115.68 7 days   0   0         FALSE                  FALSE
## 3: 2022-W10 2022-03-11 109.33 7 days   0   0         FALSE                  FALSE
## 4: 2022-W11 2022-03-18 104.70 7 days   0   0         FALSE                  FALSE
## 5: 2022-W12 2022-03-25 113.90 7 days   0   0         FALSE                  FALSE
## 6: 2022-W13 2022-04-01  99.27 7 days   0   0         FALSE                  FALSE
## 7: 2022-W14 2022-04-08  98.26 7 days   0   0         FALSE                  FALSE
## 8: 2022-W15 2022-04-14 106.95 6 days   1   0         FALSE                  FALSE
## 9: 2022-W16 2022-04-22 102.07 8 days   0   1         FALSE                  FALSE
##    Akhir 2018 - harga turun Pra-COVID COVID Pemulihan Vaksin, Varian                  2022
## 1:                    FALSE     FALSE FALSE     FALSE        Lainnya Perang Ukraina-Russia
## 2:                    FALSE     FALSE FALSE     FALSE        Lainnya Perang Ukraina-Russia
## 3:                    FALSE     FALSE FALSE     FALSE        Lainnya Perang Ukraina-Russia
## 4:                    FALSE     FALSE FALSE     FALSE        Lainnya Perang Ukraina-Russia
## 5:                    FALSE     FALSE FALSE     FALSE        Lainnya Perang Ukraina-Russia
## 6:                    FALSE     FALSE FALSE     FALSE        Lainnya Perang Ukraina-Russia
## 7:                    FALSE     FALSE FALSE     FALSE        Lainnya Perang Ukraina-Russia
## 8:                    FALSE     FALSE FALSE     FALSE        Lainnya Perang Ukraina-Russia
## 9:                    FALSE     FALSE FALSE     FALSE        Lainnya Perang Ukraina-Russia</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="analisis-intervensi-pada-model-arima.html#cb207-1" aria-hidden="true" tabindex="-1"></a>crude.ukr<span class="ot">&lt;-</span><span class="fu">subset</span>(weeklyCrude, Date<span class="sc">&lt;=</span><span class="fu">as.Date</span>(<span class="st">&quot;2022-03-04&quot;</span>))</span></code></pre></div>
<div id="arima-1" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> ARIMA<a href="analisis-intervensi-pada-model-arima.html#arima-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="cek-kestasioneran-data" class="section level4 hasAnchor" number="4.3.1.1">
<h4><span class="header-section-number">4.3.1.1</span> Cek Kestasioneran Data<a href="analisis-intervensi-pada-model-arima.html#cek-kestasioneran-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="analisis-intervensi-pada-model-arima.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(crude.ukr<span class="sc">$</span>Close)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-510-1.png" width="672" />
Model tersebut tidak stasioner karena pola ACF tersebut turun secara perlahan. jadi diperlukan differencing untuk mengatasinya.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="analisis-intervensi-pada-model-arima.html#cb209-1" aria-hidden="true" tabindex="-1"></a>crudeoil_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(crude.ukr<span class="sc">$</span>Close, <span class="at">differences=</span> <span class="dv">1</span>)</span>
<span id="cb209-2"><a href="analisis-intervensi-pada-model-arima.html#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ts.plot</span>(crudeoil_diff)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-511-1.png" width="672" />
Hasil differencing menunjukkan pola data yang stasioner dengan nilai rataan tertentu, tetapi saat COVID dan di akhir (Rusia-Ukraina) terjadi gejolak. Cek kembali dengan plot ACF.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="analisis-intervensi-pada-model-arima.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(crudeoil_diff)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-512-1.png" width="672" /></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="analisis-intervensi-pada-model-arima.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(crudeoil_diff)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-512-2.png" width="672" /></p>
<p>Plot ACF dan PACF langsung cut off setelah lag 0. Tetapi, untuk tetap mendapatkan pendugaan parameter, diduga plot crude oil tersebut mengikuti pola ARIMA(0,1,1) atah ARIMA(1,1,0).</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="analisis-intervensi-pada-model-arima.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">eacf</span>(crudeoil_diff)</span></code></pre></div>
<pre><code>## AR/MA
##   0 1 2 3 4 5 6 7 8 9 10 11 12 13
## 0 x o o o o o o o o o o  o  o  o 
## 1 o o o o o o o o o o o  o  o  o 
## 2 o x o o o o o o o o o  o  o  o 
## 3 x x x o o o o o o o o  o  o  o 
## 4 o o x o o o o o o o o  x  o  o 
## 5 x o x o o o o o o o o  o  o  o 
## 6 x o o o x o o o o o o  o  o  o 
## 7 x x o o x x o o o o o  o  o  o</code></pre>
<p>Plot EACF menghasilkan berbagai model tentatif, model tersebut adalah ARIMA(0,1,1), ARIMA(1,1,1), ARIMA(2,0,1), dan ARIMA(0,1,3). Lalu, dugalah parameter dari setiap model untuk mendapatkan model terbaik.</p>
</div>
<div id="pendugaan-parameter-1" class="section level4 hasAnchor" number="4.3.1.2">
<h4><span class="header-section-number">4.3.1.2</span> Pendugaan Parameter<a href="analisis-intervensi-pada-model-arima.html#pendugaan-parameter-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="analisis-intervensi-pada-model-arima.html#cb214-1" aria-hidden="true" tabindex="-1"></a>model1.crude1<span class="ot">=</span><span class="fu">Arima</span>(crude.ukr<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span>
<span id="cb214-2"><a href="analisis-intervensi-pada-model-arima.html#cb214-2" aria-hidden="true" tabindex="-1"></a>model1.crude2<span class="ot">=</span><span class="fu">Arima</span>(crude.ukr<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span>
<span id="cb214-3"><a href="analisis-intervensi-pada-model-arima.html#cb214-3" aria-hidden="true" tabindex="-1"></a>model1.crude3<span class="ot">=</span><span class="fu">Arima</span>(crude.ukr<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span>
<span id="cb214-4"><a href="analisis-intervensi-pada-model-arima.html#cb214-4" aria-hidden="true" tabindex="-1"></a>model1.crude4<span class="ot">=</span><span class="fu">Arima</span>(crude.ukr<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span>
<span id="cb214-5"><a href="analisis-intervensi-pada-model-arima.html#cb214-5" aria-hidden="true" tabindex="-1"></a>model1.crude5<span class="ot">=</span><span class="fu">Arima</span>(crude.ukr<span class="sc">$</span>Close, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">method=</span><span class="st">&quot;ML&quot;</span>)</span>
<span id="cb214-6"><a href="analisis-intervensi-pada-model-arima.html#cb214-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-7"><a href="analisis-intervensi-pada-model-arima.html#cb214-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb214-8"><a href="analisis-intervensi-pada-model-arima.html#cb214-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="st">&quot;ARIMA (0,1,1)&quot;</span>,<span class="st">&quot;ARIMA (1,1,0)&quot;</span>,<span class="st">&quot;ARIMA (1,1,1)&quot;</span>,<span class="st">&quot;ARIMA (2,1,1)&quot;</span>,<span class="st">&quot;ARIMA (0,1,3)&quot;</span>),</span>
<span id="cb214-9"><a href="analisis-intervensi-pada-model-arima.html#cb214-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(model1.crude1<span class="sc">$</span>aic,model1.crude2<span class="sc">$</span>aic,model1.crude3<span class="sc">$</span>aic,model1.crude4<span class="sc">$</span>aic,</span>
<span id="cb214-10"><a href="analisis-intervensi-pada-model-arima.html#cb214-10" aria-hidden="true" tabindex="-1"></a>          model1.crude5<span class="sc">$</span>aic)),</span>
<span id="cb214-11"><a href="analisis-intervensi-pada-model-arima.html#cb214-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&quot;Model&quot;</span>,<span class="st">&quot;AIC&quot;</span>)</span>
<span id="cb214-12"><a href="analisis-intervensi-pada-model-arima.html#cb214-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="left">AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ARIMA (0,1,1)</td>
<td align="left">1360.03873997845</td>
</tr>
<tr class="even">
<td align="left">ARIMA (1,1,0)</td>
<td align="left">1359.95557059779</td>
</tr>
<tr class="odd">
<td align="left">ARIMA (1,1,1)</td>
<td align="left">1361.95663763495</td>
</tr>
<tr class="even">
<td align="left">ARIMA (2,1,1)</td>
<td align="left">1363.91268743951</td>
</tr>
<tr class="odd">
<td align="left">ARIMA (0,1,3)</td>
<td align="left">1363.64651734283</td>
</tr>
</tbody>
</table>
<p>Model terbaik berdasarkan AIC: <span class="math inline">\(ARIMA(1,1,1)\)</span>. Semua koefisiennya signifikan:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="analisis-intervensi-pada-model-arima.html#cb215-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(model1.crude3)</span></code></pre></div>
<pre><code>## 
## z test of coefficients:
## 
##     Estimate Std. Error z value Pr(&gt;|z|)
## ar1 0.152885   0.706776  0.2163   0.8287
## ma1 0.026803   0.721648  0.0371   0.9704</code></pre>
</div>
<div id="diagnostik-sisaan-arima110" class="section level4 hasAnchor" number="4.3.1.3">
<h4><span class="header-section-number">4.3.1.3</span> Diagnostik Sisaan ARIMA(1,1,0)<a href="analisis-intervensi-pada-model-arima.html#diagnostik-sisaan-arima110" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="analisis-intervensi-pada-model-arima.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(model1.crude3)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-516-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,1,1)
## Q* = 6.008, df = 8, p-value = 0.6463
## 
## Model df: 2.   Total lags used: 10</code></pre>
<p>Terlihat bahwa semua diagnostik baik, kecuali sisaan tak normal karena ada beberapa amatan berpengaruh (Ukraina dan COVID). Untuk mengetahui kenormalan sisaan, terdapat 2 cara, yaitu secara eksploratif melalui Q-Q Plot, plot sisaan, plot ACF, dan plot PACF dan uji formal seperti Kolmogorov-Smirnov Test, Ljung Box Test, dan T-test.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="analisis-intervensi-pada-model-arima.html#cb219-1" aria-hidden="true" tabindex="-1"></a>sisaan.crude <span class="ot">&lt;-</span> model1.crude2<span class="sc">$</span>residuals</span>
<span id="cb219-2"><a href="analisis-intervensi-pada-model-arima.html#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb219-3"><a href="analisis-intervensi-pada-model-arima.html#cb219-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(sisaan.crude)</span>
<span id="cb219-4"><a href="analisis-intervensi-pada-model-arima.html#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(sisaan.crude, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb219-5"><a href="analisis-intervensi-pada-model-arima.html#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sisaan.crude)),sisaan.crude)</span>
<span id="cb219-6"><a href="analisis-intervensi-pada-model-arima.html#cb219-6" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(sisaan.crude)</span>
<span id="cb219-7"><a href="analisis-intervensi-pada-model-arima.html#cb219-7" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(sisaan.crude)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-517-1.png" width="672" />
Secara eksploratif, baik plot Q-Q dan sisaan terdapat pencilan di beberapa data yang membuat sisaan tersebut cenderung tidak mengikuti sebaran normal. Untuk memastikan apakah sebaran sisaan normal, perlu untuk dilakukan uji formal.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="analisis-intervensi-pada-model-arima.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(sisaan.crude,<span class="st">&quot;pnorm&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  sisaan.crude
## D = 0.22341, p-value = 3.939e-12
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="analisis-intervensi-pada-model-arima.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(sisaan.crude, <span class="at">type =</span> <span class="st">&quot;Ljung&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  sisaan.crude
## X-squared = 0.0012917, df = 1, p-value = 0.9713</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="analisis-intervensi-pada-model-arima.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sisaan.crude, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">conf.level =</span> <span class="fl">0.95</span>) </span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  sisaan.crude
## t = 1.116, df = 269, p-value = 0.2654
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -0.1557737  0.5634570
## sample estimates:
## mean of x 
## 0.2038416</code></pre>
</div>
<div id="forecasting-1" class="section level4 hasAnchor" number="4.3.1.4">
<h4><span class="header-section-number">4.3.1.4</span> Forecasting<a href="analisis-intervensi-pada-model-arima.html#forecasting-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ramalan model tersebut sebagai berikut (walaupun sebenarnya kurang tepat meramal dengan model diagnostik kurang baik):</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="analisis-intervensi-pada-model-arima.html#cb226-1" aria-hidden="true" tabindex="-1"></a>forcdefukr<span class="ot">&lt;-</span><span class="fu">forecast</span>(model1.crude2,<span class="dv">7</span>)</span>
<span id="cb226-2"><a href="analisis-intervensi-pada-model-arima.html#cb226-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-3"><a href="analisis-intervensi-pada-model-arima.html#cb226-3" aria-hidden="true" tabindex="-1"></a>weeklyCrude[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="st">&quot;fitted.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(forcdefukr<span class="sc">$</span>fitted,<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">8</span>)),  </span>
<span id="cb226-4"><a href="analisis-intervensi-pada-model-arima.html#cb226-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;predicted.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">271</span>),forcdefukr<span class="sc">$</span>mean),</span>
<span id="cb226-5"><a href="analisis-intervensi-pada-model-arima.html#cb226-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lwr.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">271</span>),forcdefukr<span class="sc">$</span>lower[,<span class="dv">2</span>]),</span>
<span id="cb226-6"><a href="analisis-intervensi-pada-model-arima.html#cb226-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;upr.def&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">271</span>),forcdefukr<span class="sc">$</span>upper[,<span class="dv">2</span>]))]</span>
<span id="cb226-7"><a href="analisis-intervensi-pada-model-arima.html#cb226-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-8"><a href="analisis-intervensi-pada-model-arima.html#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>weeklyCrude[<span class="dv">260</span><span class="sc">:</span><span class="dv">277</span>])<span class="sc">+</span></span>
<span id="cb226-9"><a href="analisis-intervensi-pada-model-arima.html#cb226-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>)<span class="sc">+</span></span>
<span id="cb226-10"><a href="analisis-intervensi-pada-model-arima.html#cb226-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted.def,<span class="at">color=</span><span class="st">&quot;Fitted&quot;</span>))<span class="sc">+</span></span>
<span id="cb226-11"><a href="analisis-intervensi-pada-model-arima.html#cb226-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.def,<span class="at">color=</span><span class="st">&quot;Prediksi&quot;</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb226-12"><a href="analisis-intervensi-pada-model-arima.html#cb226-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.def,<span class="at">ymax=</span>upr.def, <span class="at">color=</span><span class="st">&quot;Prediksi&quot;</span>, </span>
<span id="cb226-13"><a href="analisis-intervensi-pada-model-arima.html#cb226-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Prediksi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb226-14"><a href="analisis-intervensi-pada-model-arima.html#cb226-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb226-15"><a href="analisis-intervensi-pada-model-arima.html#cb226-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Prediksi&#39;</span>),</span>
<span id="cb226-16"><a href="analisis-intervensi-pada-model-arima.html#cb226-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, <span class="st">&#39;Prediksi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>))<span class="sc">+</span></span>
<span id="cb226-17"><a href="analisis-intervensi-pada-model-arima.html#cb226-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb226-18"><a href="analisis-intervensi-pada-model-arima.html#cb226-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Prediksi&#39;</span>),</span>
<span id="cb226-19"><a href="analisis-intervensi-pada-model-arima.html#cb226-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, <span class="st">&#39;Prediksi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>))<span class="sc">+</span></span>
<span id="cb226-20"><a href="analisis-intervensi-pada-model-arima.html#cb226-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot; &quot;</span>)</span></code></pre></div>
<pre><code>## Scale for &#39;colour&#39; is already present. Adding another scale for &#39;colour&#39;, which will replace
## the existing scale.</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-519-1.png" width="672" /></p>
</div>
</div>
<div id="arimax" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> ARIMAX<a href="analisis-intervensi-pada-model-arima.html#arimax" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Prediksi tersebut cukup tinggi. Bagaimana dengan model ARIMAX - akan ditambahkan peubah <em>dummy</em> untuk COVID dan Ukraina. Sebenarnya bisa saja dimodelkan hal seperti vaksinasi, varian Delta, dan Omicron, tetapi agar model tetap sederhana model dua hal itu saja. Untuk spesifikasi <em>dummy</em> Ukraina, akan diuji <span class="math inline">\(MA(0)\)</span> - kenaikan intersep, <span class="math inline">\(MA(1)\)</span>, <span class="math inline">\(AR(1)\)</span>, dan <span class="math inline">\(ARMA(1)\)</span>:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="analisis-intervensi-pada-model-arima.html#cb228-1" aria-hidden="true" tabindex="-1"></a>ukrmax1<span class="ot">&lt;-</span><span class="fu">arimax</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb228-2"><a href="analisis-intervensi-pada-model-arima.html#cb228-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb228-3"><a href="analisis-intervensi-pada-model-arima.html#cb228-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">UR=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">269</span>)),</span>
<span id="cb228-4"><a href="analisis-intervensi-pada-model-arima.html#cb228-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)))</span>
<span id="cb228-5"><a href="analisis-intervensi-pada-model-arima.html#cb228-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-6"><a href="analisis-intervensi-pada-model-arima.html#cb228-6" aria-hidden="true" tabindex="-1"></a>ukrmax2<span class="ot">&lt;-</span><span class="fu">arimax</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb228-7"><a href="analisis-intervensi-pada-model-arima.html#cb228-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb228-8"><a href="analisis-intervensi-pada-model-arima.html#cb228-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">UR=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">269</span>)),</span>
<span id="cb228-9"><a href="analisis-intervensi-pada-model-arima.html#cb228-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span>
<span id="cb228-10"><a href="analisis-intervensi-pada-model-arima.html#cb228-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-11"><a href="analisis-intervensi-pada-model-arima.html#cb228-11" aria-hidden="true" tabindex="-1"></a>ukrmax3<span class="ot">&lt;-</span><span class="fu">arimax</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb228-12"><a href="analisis-intervensi-pada-model-arima.html#cb228-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb228-13"><a href="analisis-intervensi-pada-model-arima.html#cb228-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">UR=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">269</span>)),</span>
<span id="cb228-14"><a href="analisis-intervensi-pada-model-arima.html#cb228-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>)))</span>
<span id="cb228-15"><a href="analisis-intervensi-pada-model-arima.html#cb228-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-16"><a href="analisis-intervensi-pada-model-arima.html#cb228-16" aria-hidden="true" tabindex="-1"></a>ukrmax4<span class="ot">&lt;-</span><span class="fu">arimax</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb228-17"><a href="analisis-intervensi-pada-model-arima.html#cb228-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb228-18"><a href="analisis-intervensi-pada-model-arima.html#cb228-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">UR=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">269</span>)),</span>
<span id="cb228-19"><a href="analisis-intervensi-pada-model-arima.html#cb228-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)))</span></code></pre></div>
<p>Bandingkan AIC tiap spesifikasi tersebut:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="analisis-intervensi-pada-model-arima.html#cb229-1" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">cbind</span>(ukrmax1<span class="sc">$</span>aic, ukrmax2<span class="sc">$</span>aic, ukrmax3<span class="sc">$</span>aic, ukrmax4<span class="sc">$</span>aic),  </span>
<span id="cb229-2"><a href="analisis-intervensi-pada-model-arima.html#cb229-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&quot;MA(0)&quot;</span>,<span class="st">&quot;MA(1)&quot;</span>,<span class="st">&quot;AR(1)&quot;</span>, <span class="st">&quot;ARMA(1,1)&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">MA(0)</th>
<th align="right">MA(1)</th>
<th align="right">AR(1)</th>
<th align="right">ARMA(1,1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1301.586</td>
<td align="right">1258.96</td>
<td align="right">1253.242</td>
<td align="right">1288.709</td>
</tr>
</tbody>
</table>
<p>Terlihat bahwa spesifikasi AR(1) atau MA(1) baik:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="analisis-intervensi-pada-model-arima.html#cb230-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(ukrmax2)</span></code></pre></div>
<pre><code>## 
## z test of coefficients:
## 
##              Estimate  Std. Error  z value  Pr(&gt;|z|)    
## ar1         0.0630424   0.0619903   1.0170  0.309167    
## COVID-AR1   0.9131724   0.0031859 286.6304 &lt; 2.2e-16 ***
## COVID-MA0  -7.9050997   2.4722178  -3.1976  0.001386 ** 
## COVID-MA1  -3.1209729   2.4942996  -1.2512  0.210846    
## COVID-MA2 -13.2774945   2.5025092  -5.3057 1.123e-07 ***
## COVID-MA3 -13.5402925   2.4858155  -5.4470 5.122e-08 ***
## UR-MA0     -2.7845351   2.5369932  -1.0976  0.272391    
## UR-MA1     23.2988355   3.6560972   6.3726 1.859e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="analisis-intervensi-pada-model-arima.html#cb232-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(ukrmax3)</span></code></pre></div>
<pre><code>## 
## z test of coefficients:
## 
##             Estimate Std. Error  z value  Pr(&gt;|z|)    
## ar1        0.1214257  0.0623438   1.9477 0.0514535 .  
## COVID-AR1  0.9639880  0.0034178 282.0488 &lt; 2.2e-16 ***
## COVID-MA0 -7.5840609  2.4970764  -3.0372 0.0023881 ** 
## COVID-MA1 -2.7376270  2.5313652  -1.0815 0.2794826    
## COVID-MA2 -9.2578375  2.5230528  -3.6693 0.0002432 ***
## COVID-MA3 -9.8727174  2.4939425  -3.9587 7.537e-05 ***
## UR-AR1    -5.3896474  2.2713904  -2.3728 0.0176519 *  
## UR-MA0    -3.5540212  1.2254026  -2.9003 0.0037282 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Tampaknya lebih banyak koefisien signifikan di spesifikasi AR, tapi kita harus pikirkan implikasi dari memilih model tersebut. Efek awal perang sebesar <span class="math inline">\(-3.55\)</span>. Lalu dikalikan <span class="math inline">\(-5.389\)</span> menjadi sekitar 15. Lalu dikalikan lagi menjadi sekitar <span class="math inline">\(-75\)</span>. Dugaan tersebut tentu sangat aneh - harga berflukutasi plus-minus sangat besar. Uji residual model tersebut.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="analisis-intervensi-pada-model-arima.html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(ukrmax2)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-523-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,1,0)
## Q* = 17.012, df = 3, p-value = 0.0007028
## 
## Model df: 8.   Total lags used: 11</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="analisis-intervensi-pada-model-arima.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(ukrmax3)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-523-2.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,1,0)
## Q* = 14.116, df = 3, p-value = 0.002752
## 
## Model df: 8.   Total lags used: 11</code></pre>
<p>Spesifikasi intervensi <span class="math inline">\(AR(1)\)</span> lebih baik dalam uji Ljung-Box. Namun, kedua spesifikasi berhasil mengatasi masalah non-normaltas. Walaupun begitu, akan tetap diambil spesifikasi <span class="math inline">\(MA(1)\)</span> karena ramalan spesifikasi intervensi <span class="math inline">\(AR(1)\)</span> akan aneh.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="analisis-intervensi-pada-model-arima.html#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arimax</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb238-2"><a href="analisis-intervensi-pada-model-arima.html#cb238-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb238-3"><a href="analisis-intervensi-pada-model-arima.html#cb238-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">UR=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">269</span>)),</span>
<span id="cb238-4"><a href="analisis-intervensi-pada-model-arima.html#cb238-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">fixed=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">0</span>,<span class="cn">NA</span>),</span>
<span id="cb238-5"><a href="analisis-intervensi-pada-model-arima.html#cb238-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## 
## Call:
## arimax(x = crude.ukr$Close, order = c(1, 1, 0), fixed = c(NA, NA, NA, NA, NA, 
##     NA, 0, NA), xtransf = data.frame(COVID = 1 * (seq(nrow(crude.ukr)) == 165), 
##     UR = 1 * (seq(nrow(crude.ukr)) == 269)), transfer = list(c(1, 3), c(0, 1)))
## 
## Coefficients:
##          ar1  COVID-AR1  COVID-MA0  COVID-MA1  COVID-MA2  COVID-MA3  UR-MA0   UR-MA1
##       0.1120     0.8776    -7.7107    -3.6061    -9.6746   -10.0563       0  24.1401
## s.e.  0.0611     0.0085     2.4211     2.4530     2.4534     2.4282       0   2.4834
## 
## sigma^2 estimated as 6.165:  log likelihood = -619.36,  aic = 1252.73</code></pre>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="analisis-intervensi-pada-model-arima.html#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arimax</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb240-2"><a href="analisis-intervensi-pada-model-arima.html#cb240-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb240-3"><a href="analisis-intervensi-pada-model-arima.html#cb240-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">UR=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">269</span>)),</span>
<span id="cb240-4"><a href="analisis-intervensi-pada-model-arima.html#cb240-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">fixed=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb240-5"><a href="analisis-intervensi-pada-model-arima.html#cb240-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## Warning in arimax(crude.ukr$Close, order = c(1, 1, 0), xtransf = data.frame(COVID = 1 * : some
## AR parameters were fixed: setting transform.pars = FALSE</code></pre>
<pre><code>## 
## Call:
## arimax(x = crude.ukr$Close, order = c(1, 1, 0), fixed = c(0, NA, NA, NA, NA, 
##     NA, NA, NA), xtransf = data.frame(COVID = 1 * (seq(nrow(crude.ukr)) == 165), 
##     UR = 1 * (seq(nrow(crude.ukr)) == 269)), transfer = list(c(1, 3), c(0, 1)))
## 
## Coefficients:
##       ar1  COVID-AR1  COVID-MA0  COVID-MA1  COVID-MA2  COVID-MA3   UR-MA0   UR-MA1
##         0     0.9036    -6.7365    -2.8745    -9.9998   -11.3642  -1.2627  23.2504
## s.e.    0     0.0032     2.4649     2.4647     2.4620     2.4619   2.4988   3.5290
## 
## sigma^2 estimated as 6.22:  log likelihood = -620.53,  aic = 1255.05</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="analisis-intervensi-pada-model-arima.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arimax</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb243-2"><a href="analisis-intervensi-pada-model-arima.html#cb243-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb243-3"><a href="analisis-intervensi-pada-model-arima.html#cb243-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">UR=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">269</span>)),</span>
<span id="cb243-4"><a href="analisis-intervensi-pada-model-arima.html#cb243-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">fixed=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">0</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>),</span>
<span id="cb243-5"><a href="analisis-intervensi-pada-model-arima.html#cb243-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## 
## Call:
## arimax(x = crude.ukr$Close, order = c(1, 1, 0), fixed = c(NA, NA, NA, 0, NA, 
##     NA, NA, NA), xtransf = data.frame(COVID = 1 * (seq(nrow(crude.ukr)) == 165), 
##     UR = 1 * (seq(nrow(crude.ukr)) == 269)), transfer = list(c(1, 3), c(0, 1)))
## 
## Coefficients:
##          ar1  COVID-AR1  COVID-MA0  COVID-MA1  COVID-MA2  COVID-MA3  UR-MA0   UR-MA1
##       0.0780     0.9020    -7.6950          0    -8.8418   -10.0956  0.9246  23.4750
## s.e.  0.0619     0.0033     2.4405          0     2.4748     2.4754  2.4887   3.6613
## 
## sigma^2 estimated as 6.192:  log likelihood = -619.94,  aic = 1253.87</code></pre>
<p>Terlihat bahwa membuat koefisien <span class="math inline">\(MA(0)\)</span> di intervensi Ukraina menurunkan AIC dan nampaknya meningkatkan nilai semua koefisien relatif ke s.e-nya:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="analisis-intervensi-pada-model-arima.html#cb245-1" aria-hidden="true" tabindex="-1"></a>intvmodukr<span class="ot">&lt;-</span> <span class="fu">arimax</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb245-2"><a href="analisis-intervensi-pada-model-arima.html#cb245-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb245-3"><a href="analisis-intervensi-pada-model-arima.html#cb245-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">UR=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">269</span>)),</span>
<span id="cb245-4"><a href="analisis-intervensi-pada-model-arima.html#cb245-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">fixed=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">0</span>,<span class="cn">NA</span>),</span>
<span id="cb245-5"><a href="analisis-intervensi-pada-model-arima.html#cb245-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span></code></pre></div>
<p>Data tidak saling bebas, tetapi semua koefisien beda signifikan dari nol di taraf <span class="math inline">\(15\%\)</span></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="analisis-intervensi-pada-model-arima.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">checkresiduals</span>(intvmodukr)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-526-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ARIMA(1,1,0)
## Q* = 14.131, df = 3, p-value = 0.002732
## 
## Model df: 8.   Total lags used: 11</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="analisis-intervensi-pada-model-arima.html#cb248-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(intvmodukr)</span></code></pre></div>
<pre><code>## 
## z test of coefficients:
## 
##              Estimate  Std. Error  z value  Pr(&gt;|z|)    
## ar1         0.1119553   0.0611338   1.8313  0.067054 .  
## COVID-AR1   0.8776212   0.0085152 103.0651 &lt; 2.2e-16 ***
## COVID-MA0  -7.7107394   2.4211345  -3.1848  0.001449 ** 
## COVID-MA1  -3.6060833   2.4529518  -1.4701  0.141535    
## COVID-MA2  -9.6746293   2.4533577  -3.9434 8.033e-05 ***
## COVID-MA3 -10.0562834   2.4282167  -4.1414 3.452e-05 ***
## UR-MA1     24.1400639   2.4833877   9.7206 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Namun ts diag dan ACF menandakan bahwa residual tidak berkorelasi. Kebanyakan garis tidak melewati signifikansi, dan p-values Ljung-Box di berbagai lag berada di atas garis juga.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="analisis-intervensi-pada-model-arima.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(intvmodukr<span class="sc">$</span>residuals, <span class="at">lag.max=</span><span class="dv">250</span>, <span class="at">na.action=</span>na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-527-1.png" width="672" /></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="analisis-intervensi-pada-model-arima.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tsdiag</span>(intvmodukr, <span class="at">gof.lag=</span><span class="dv">250</span>,<span class="at">na.action=</span>na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-527-2.png" width="672" /></p>
<p>Sekarang, lakukan ramalan dengan model tersebut, dengan fungsi filter:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="analisis-intervensi-pada-model-arima.html#cb252-1" aria-hidden="true" tabindex="-1"></a>COVID<span class="ot">=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(weeklyCrude))<span class="sc">==</span><span class="dv">165</span>)</span>
<span id="cb252-2"><a href="analisis-intervensi-pada-model-arima.html#cb252-2" aria-hidden="true" tabindex="-1"></a>covreg<span class="ot">&lt;-</span>stats<span class="sc">::</span><span class="fu">filter</span>(COVID,<span class="fu">c</span>(<span class="sc">-</span><span class="fl">7.7107</span>, <span class="sc">-</span><span class="fl">3.6061</span>, <span class="sc">-</span><span class="fl">9.6746</span>, <span class="sc">-</span><span class="fl">10.0563</span>  ),<span class="st">&quot;convolution&quot;</span>,<span class="at">sides=</span><span class="dv">1</span>)</span>
<span id="cb252-3"><a href="analisis-intervensi-pada-model-arima.html#cb252-3" aria-hidden="true" tabindex="-1"></a>covreg[<span class="fu">is.na</span>(covreg)]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb252-4"><a href="analisis-intervensi-pada-model-arima.html#cb252-4" aria-hidden="true" tabindex="-1"></a>covreg<span class="ot">&lt;-</span>stats<span class="sc">::</span><span class="fu">filter</span>(covreg,<span class="fl">0.1120</span>,<span class="st">&quot;recursive&quot;</span>,<span class="at">sides=</span><span class="dv">1</span>)</span>
<span id="cb252-5"><a href="analisis-intervensi-pada-model-arima.html#cb252-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-6"><a href="analisis-intervensi-pada-model-arima.html#cb252-6" aria-hidden="true" tabindex="-1"></a>UR<span class="ot">=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(weeklyCrude))<span class="sc">==</span><span class="dv">269</span>)</span>
<span id="cb252-7"><a href="analisis-intervensi-pada-model-arima.html#cb252-7" aria-hidden="true" tabindex="-1"></a>URReg<span class="ot">&lt;-</span>stats<span class="sc">::</span><span class="fu">filter</span>(UR,<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">24.1401</span>),<span class="st">&quot;convolution&quot;</span>,<span class="at">sides=</span><span class="dv">1</span>)</span></code></pre></div>
<p>Lalu masukkan ke Arima:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="analisis-intervensi-pada-model-arima.html#cb253-1" aria-hidden="true" tabindex="-1"></a>modfin.ukr<span class="ot">&lt;-</span><span class="fu">Arima</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb253-2"><a href="analisis-intervensi-pada-model-arima.html#cb253-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">xreg=</span><span class="fu">cbind</span>(covreg,URReg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">270</span>,])</span>
<span id="cb253-3"><a href="analisis-intervensi-pada-model-arima.html#cb253-3" aria-hidden="true" tabindex="-1"></a>modfin.ukr</span></code></pre></div>
<pre><code>## Series: crude.ukr$Close 
## Regression with ARIMA(1,1,0) errors 
## 
## Coefficients:
##          ar1  covreg   URReg
##       0.1706  0.5341  0.9943
## s.e.  0.0602  0.1740  0.1071
## 
## sigma^2 = 6.764:  log likelihood = -634.94
## AIC=1277.88   AICc=1278.03   BIC=1292.24</code></pre>
<p>Koefisien intervensi Ukraina mendekati 1, tetapi tidak untuk COVID. Lakukan pendugaan dan plot:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="analisis-intervensi-pada-model-arima.html#cb255-1" aria-hidden="true" tabindex="-1"></a>forc.inv.ukr<span class="ot">&lt;-</span><span class="fu">forecast</span>(modfin.ukr,<span class="dv">7</span>,<span class="at">xreg=</span><span class="fu">cbind</span>(covreg,URReg)[<span class="dv">272</span><span class="sc">:</span><span class="dv">278</span>,])</span>
<span id="cb255-2"><a href="analisis-intervensi-pada-model-arima.html#cb255-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-3"><a href="analisis-intervensi-pada-model-arima.html#cb255-3" aria-hidden="true" tabindex="-1"></a>weeklyCrude[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="st">&quot;fitted.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(forc.inv.ukr<span class="sc">$</span>fitted,<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">8</span>)),  </span>
<span id="cb255-4"><a href="analisis-intervensi-pada-model-arima.html#cb255-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;predicted.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">271</span>),forc.inv.ukr<span class="sc">$</span>mean),</span>
<span id="cb255-5"><a href="analisis-intervensi-pada-model-arima.html#cb255-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lwr.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">271</span>),forc.inv.ukr<span class="sc">$</span>lower[,<span class="dv">2</span>]),</span>
<span id="cb255-6"><a href="analisis-intervensi-pada-model-arima.html#cb255-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;upr.intv&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">271</span>),forc.inv.ukr<span class="sc">$</span>upper[,<span class="dv">2</span>]))]</span>
<span id="cb255-7"><a href="analisis-intervensi-pada-model-arima.html#cb255-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-8"><a href="analisis-intervensi-pada-model-arima.html#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>weeklyCrude[<span class="dv">260</span><span class="sc">:</span><span class="dv">278</span>])<span class="sc">+</span></span>
<span id="cb255-9"><a href="analisis-intervensi-pada-model-arima.html#cb255-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>)<span class="sc">+</span></span>
<span id="cb255-10"><a href="analisis-intervensi-pada-model-arima.html#cb255-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted.intv,<span class="at">color=</span><span class="st">&quot;Fitted&quot;</span>))<span class="sc">+</span></span>
<span id="cb255-11"><a href="analisis-intervensi-pada-model-arima.html#cb255-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.def,<span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb255-12"><a href="analisis-intervensi-pada-model-arima.html#cb255-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.def,<span class="at">ymax=</span>upr.def, <span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>, </span>
<span id="cb255-13"><a href="analisis-intervensi-pada-model-arima.html#cb255-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb255-14"><a href="analisis-intervensi-pada-model-arima.html#cb255-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.intv,<span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">size=</span><span class="dv">3</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb255-15"><a href="analisis-intervensi-pada-model-arima.html#cb255-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.intv,<span class="at">ymax=</span>upr.intv, <span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>, </span>
<span id="cb255-16"><a href="analisis-intervensi-pada-model-arima.html#cb255-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb255-17"><a href="analisis-intervensi-pada-model-arima.html#cb255-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb255-18"><a href="analisis-intervensi-pada-model-arima.html#cb255-18" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb255-19"><a href="analisis-intervensi-pada-model-arima.html#cb255-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb255-20"><a href="analisis-intervensi-pada-model-arima.html#cb255-20" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb255-21"><a href="analisis-intervensi-pada-model-arima.html#cb255-21" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb255-22"><a href="analisis-intervensi-pada-model-arima.html#cb255-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb255-23"><a href="analisis-intervensi-pada-model-arima.html#cb255-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, <span class="st">&#39;Intervensi&#39;</span> ),</span>
<span id="cb255-24"><a href="analisis-intervensi-pada-model-arima.html#cb255-24" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb255-25"><a href="analisis-intervensi-pada-model-arima.html#cb255-25" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb255-26"><a href="analisis-intervensi-pada-model-arima.html#cb255-26" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span> ))<span class="sc">+</span></span>
<span id="cb255-27"><a href="analisis-intervensi-pada-model-arima.html#cb255-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot; &quot;</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot; Perbandingan Model Intervensi dan non-Intervensi terbaik&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-530-1.png" width="672" /></p>
<p>Model intervensi menduga harga minyak lebih rendah daripada model intervensi. Namun, tidak terlihat jelas mana model yang lebih baik. Bandingkan nilai akurasi:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="analisis-intervensi-pada-model-arima.html#cb256-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close,</span>
<span id="cb256-2"><a href="analisis-intervensi-pada-model-arima.html#cb256-2" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.def),</span>
<span id="cb256-3"><a href="analisis-intervensi-pada-model-arima.html#cb256-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close,</span>
<span id="cb256-4"><a href="analisis-intervensi-pada-model-arima.html#cb256-4" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.intv))</span>
<span id="cb256-5"><a href="analisis-intervensi-pada-model-arima.html#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>)</span>
<span id="cb256-6"><a href="analisis-intervensi-pada-model-arima.html#cb256-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-7"><a href="analisis-intervensi-pada-model-arima.html#cb256-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb256-8"><a href="analisis-intervensi-pada-model-arima.html#cb256-8" aria-hidden="true" tabindex="-1"></a>        compAcc,</span>
<span id="cb256-9"><a href="analisis-intervensi-pada-model-arima.html#cb256-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>T,</span>
<span id="cb256-10"><a href="analisis-intervensi-pada-model-arima.html#cb256-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span><span class="dv">4</span></span>
<span id="cb256-11"><a href="analisis-intervensi-pada-model-arima.html#cb256-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">17.3866</td>
<td align="right">18.1892</td>
<td align="right">17.3866</td>
<td align="right">14.3930</td>
<td align="right">14.3930</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">-11.6907</td>
<td align="right">12.8181</td>
<td align="right">11.6907</td>
<td align="right">-12.7498</td>
<td align="right">12.7498</td>
</tr>
</tbody>
</table>
<p>Model intervensi memiliki MAE dan RMSE lebih rendah, tapi MAPE lebih tinggi. MAPE memberikan penalti lebih besar pada error yang negatif <span class="citation">(<a href="#ref-fpp3" role="doc-biblioref">Hyndman dan Athanasopoulos 2021</a>)</span>, sehingga dalam kasus ini MAE dan RMSE lebih dapat dipercaya - model intervensi baik. Ini juga terlihat di training:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="analisis-intervensi-pada-model-arima.html#cb257-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>],</span>
<span id="cb257-2"><a href="analisis-intervensi-pada-model-arima.html#cb257-2" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.def[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>]),</span>
<span id="cb257-3"><a href="analisis-intervensi-pada-model-arima.html#cb257-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>],</span>
<span id="cb257-4"><a href="analisis-intervensi-pada-model-arima.html#cb257-4" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.intv[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>]))</span>
<span id="cb257-5"><a href="analisis-intervensi-pada-model-arima.html#cb257-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>)</span>
<span id="cb257-6"><a href="analisis-intervensi-pada-model-arima.html#cb257-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-7"><a href="analisis-intervensi-pada-model-arima.html#cb257-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb257-8"><a href="analisis-intervensi-pada-model-arima.html#cb257-8" aria-hidden="true" tabindex="-1"></a>        compAcc,</span>
<span id="cb257-9"><a href="analisis-intervensi-pada-model-arima.html#cb257-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>T,</span>
<span id="cb257-10"><a href="analisis-intervensi-pada-model-arima.html#cb257-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span><span class="dv">4</span></span>
<span id="cb257-11"><a href="analisis-intervensi-pada-model-arima.html#cb257-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">14.5981</td>
<td align="right">15.8018</td>
<td align="right">14.5981</td>
<td align="right">12.1083</td>
<td align="right">12.1083</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">-14.2638</td>
<td align="right">15.4893</td>
<td align="right">14.2638</td>
<td align="right">-15.5560</td>
<td align="right">15.5560</td>
</tr>
</tbody>
</table>
<p>Namun, di jangka waktu pendek model tanpa intervensi lebih baik ramalannya.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="analisis-intervensi-pada-model-arima.html#cb258-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(model1.crude2),</span>
<span id="cb258-2"><a href="analisis-intervensi-pada-model-arima.html#cb258-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(intvmodukr))</span>
<span id="cb258-3"><a href="analisis-intervensi-pada-model-arima.html#cb258-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>)</span>
<span id="cb258-4"><a href="analisis-intervensi-pada-model-arima.html#cb258-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-5"><a href="analisis-intervensi-pada-model-arima.html#cb258-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb258-6"><a href="analisis-intervensi-pada-model-arima.html#cb258-6" aria-hidden="true" tabindex="-1"></a>        compAcc,</span>
<span id="cb258-7"><a href="analisis-intervensi-pada-model-arima.html#cb258-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>T,</span>
<span id="cb258-8"><a href="analisis-intervensi-pada-model-arima.html#cb258-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span><span class="dv">4</span></span>
<span id="cb258-9"><a href="analisis-intervensi-pada-model-arima.html#cb258-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
<th align="right">MASE</th>
<th align="right">ACF1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">0.2038</td>
<td align="right">3.0027</td>
<td align="right">2.0795</td>
<td align="right">0.1035</td>
<td align="right">4.0328</td>
<td align="right">0.9848</td>
<td align="right">-0.0022</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">0.1278</td>
<td align="right">2.4784</td>
<td align="right">1.9133</td>
<td align="right">-0.0426</td>
<td align="right">3.7524</td>
<td align="right">0.9061</td>
<td align="right">-0.0051</td>
</tr>
</tbody>
</table>
<p>Model intervensi memiliki akurasi lebih baik di training juga.</p>
</div>
<div id="rev-penanganan-autokorelasi" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Rev: Penanganan autokorelasi<a href="analisis-intervensi-pada-model-arima.html#rev-penanganan-autokorelasi" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Model intervensi Ukraina sebelumnya memiliki masalah autokorelasi. Ditemukan bahwa dengan menambah satu term MA pada intervensi COVID, autokorelasi tersebut hilang:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="analisis-intervensi-pada-model-arima.html#cb259-1" aria-hidden="true" tabindex="-1"></a>intvmod.noautocor<span class="ot">&lt;-</span><span class="fu">arimax</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb259-2"><a href="analisis-intervensi-pada-model-arima.html#cb259-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">xtransf=</span><span class="fu">data.frame</span>(<span class="at">COVID=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">165</span>),</span>
<span id="cb259-3"><a href="analisis-intervensi-pada-model-arima.html#cb259-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">UR=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(crude.ukr))<span class="sc">==</span><span class="dv">269</span>)),</span>
<span id="cb259-4"><a href="analisis-intervensi-pada-model-arima.html#cb259-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">fixed=</span><span class="fu">c</span>(<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="cn">NA</span>,<span class="dv">0</span>,<span class="cn">NA</span>),</span>
<span id="cb259-5"><a href="analisis-intervensi-pada-model-arima.html#cb259-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">transfer=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)))</span></code></pre></div>
<p>Dapat dilihat bahwa ACF tidak melewati garis signifikansi:</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="analisis-intervensi-pada-model-arima.html#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(intvmod.noautocor<span class="sc">$</span>residuals, <span class="at">na.action=</span>na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-535-1.png" width="672" /></p>
<p>Tidak ada autokorelasi yang berbeda signifikan dari nol di lag sampai 20. Jika ditambah sampai lag yang sangat banyak:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="analisis-intervensi-pada-model-arima.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(intvmod.noautocor<span class="sc">$</span>residuals, <span class="at">na.action=</span>na.pass, <span class="at">lag.max=</span><span class="dv">250</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-536-1.png" width="672" /></p>
<p>Terdapat autokorelasi yang melewati garis, tapi sudah relatif jauh (lebih dari lag 50). Begitu juga untuk tsdiag:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="analisis-intervensi-pada-model-arima.html#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tsdiag</span>(intvmod.noautocor, <span class="at">gof.lag=</span><span class="dv">100</span>, <span class="at">na.action=</span>na.pass)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-537-1.png" width="672" /></p>
<p>Di kebanyakan lag, hipotesis bahwa galat saling bebas tidak ditolak oleh uji Ljung-Box.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="analisis-intervensi-pada-model-arima.html#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(intvmod.noautocor<span class="sc">$</span>residuals)</span>
<span id="cb263-2"><a href="analisis-intervensi-pada-model-arima.html#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(intvmod.noautocor<span class="sc">$</span>residuals)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-538-1.png" width="672" /></p>
<p>Secara eksploratif residual tampak normal, begitu juga secara uji:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="analisis-intervensi-pada-model-arima.html#cb264-1" aria-hidden="true" tabindex="-1"></a>nonas<span class="ot">&lt;-</span>intvmod.noautocor<span class="sc">$</span>residuals[<span class="sc">!</span><span class="fu">is.na</span>(intvmod.noautocor<span class="sc">$</span>residuals)]</span>
<span id="cb264-2"><a href="analisis-intervensi-pada-model-arima.html#cb264-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-3"><a href="analisis-intervensi-pada-model-arima.html#cb264-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(nonas,pnorm, </span>
<span id="cb264-4"><a href="analisis-intervensi-pada-model-arima.html#cb264-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mean</span>(nonas),</span>
<span id="cb264-5"><a href="analisis-intervensi-pada-model-arima.html#cb264-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sd</span>(nonas))</span></code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  nonas
## D = 0.047157, p-value = 0.5951
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="analisis-intervensi-pada-model-arima.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(nonas)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  nonas
## W = 0.99572, p-value = 0.6778</code></pre>
<p>Residual nampak normal. Forecasting dilakukan dengan melihat koefisien:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="analisis-intervensi-pada-model-arima.html#cb268-1" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">coeftest</span>(intvmod.noautocor)</span></code></pre></div>
<pre><code>## 
## z test of coefficients:
## 
##             Estimate Std. Error z value  Pr(&gt;|z|)    
## ar1         0.197018   0.060626  3.2497  0.001155 ** 
## COVID-AR1  -0.078669   0.185484 -0.4241  0.671473    
## COVID-MA0  -5.236379   2.293745 -2.2829  0.022437 *  
## COVID-MA1  -4.806999   3.226176 -1.4900  0.136225    
## COVID-MA2  -9.796430   3.547651 -2.7614  0.005756 ** 
## COVID-MA3 -14.950299   3.212270 -4.6541 3.254e-06 ***
## COVID-MA4 -11.691369   2.289597 -5.1063 3.285e-07 ***
## UR-MA1     23.987798   2.486882  9.6457 &lt; 2.2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="analisis-intervensi-pada-model-arima.html#cb270-1" aria-hidden="true" tabindex="-1"></a>intvmod.noautocor</span></code></pre></div>
<pre><code>## 
## Call:
## arimax(x = crude.ukr$Close, order = c(1, 1, 0), fixed = c(NA, NA, NA, NA, NA, 
##     NA, NA, 0, NA), xtransf = data.frame(COVID = 1 * (seq(nrow(crude.ukr)) == 
##     165), UR = 1 * (seq(nrow(crude.ukr)) == 269)), transfer = list(c(1, 4), 
##     c(0, 1)))
## 
## Coefficients:
##          ar1  COVID-AR1  COVID-MA0  COVID-MA1  COVID-MA2  COVID-MA3  COVID-MA4  UR-MA0   UR-MA1
##       0.1970    -0.0787    -5.2364    -4.8070    -9.7964   -14.9503   -11.6914       0  23.9878
## s.e.  0.0606     0.1855     2.2937     3.2262     3.5477     3.2123     2.2896       0   2.4869
## 
## sigma^2 estimated as 6.184:  log likelihood = -617.44,  aic = 1250.88</code></pre>
<p>Ada masalah dalam kasus ini, yaitu koefisien AR tidak signifikan. Walaupun begitu lanjutkan saja forecasting:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="analisis-intervensi-pada-model-arima.html#cb272-1" aria-hidden="true" tabindex="-1"></a>COVID<span class="ot">=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(weeklyCrude))<span class="sc">==</span><span class="dv">165</span>)</span>
<span id="cb272-2"><a href="analisis-intervensi-pada-model-arima.html#cb272-2" aria-hidden="true" tabindex="-1"></a>covreg<span class="ot">&lt;-</span>stats<span class="sc">::</span><span class="fu">filter</span>(COVID,<span class="fu">c</span>(<span class="sc">-</span><span class="fl">5.2364</span>,<span class="sc">-</span><span class="fl">4.8070</span>,<span class="sc">-</span><span class="fl">9.7964</span>,<span class="sc">-</span><span class="fl">14.9503</span>,<span class="sc">-</span><span class="fl">11.6914</span> ),<span class="st">&quot;convolution&quot;</span>,<span class="at">sides=</span><span class="dv">1</span>)</span>
<span id="cb272-3"><a href="analisis-intervensi-pada-model-arima.html#cb272-3" aria-hidden="true" tabindex="-1"></a>covreg[<span class="fu">is.na</span>(covreg)]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb272-4"><a href="analisis-intervensi-pada-model-arima.html#cb272-4" aria-hidden="true" tabindex="-1"></a>covreg<span class="ot">&lt;-</span>stats<span class="sc">::</span><span class="fu">filter</span>(covreg,<span class="sc">-</span><span class="fl">0.0787</span>,<span class="st">&quot;recursive&quot;</span>,<span class="at">sides=</span><span class="dv">1</span>)</span>
<span id="cb272-5"><a href="analisis-intervensi-pada-model-arima.html#cb272-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-6"><a href="analisis-intervensi-pada-model-arima.html#cb272-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-7"><a href="analisis-intervensi-pada-model-arima.html#cb272-7" aria-hidden="true" tabindex="-1"></a>UR<span class="ot">=</span><span class="dv">1</span><span class="sc">*</span>(<span class="fu">seq</span>(<span class="fu">nrow</span>(weeklyCrude))<span class="sc">==</span><span class="dv">269</span>)</span>
<span id="cb272-8"><a href="analisis-intervensi-pada-model-arima.html#cb272-8" aria-hidden="true" tabindex="-1"></a>URReg<span class="ot">&lt;-</span>stats<span class="sc">::</span><span class="fu">filter</span>(UR,<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">23.9878</span>),<span class="st">&quot;convolution&quot;</span>,<span class="at">sides=</span><span class="dv">1</span>)</span>
<span id="cb272-9"><a href="analisis-intervensi-pada-model-arima.html#cb272-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-10"><a href="analisis-intervensi-pada-model-arima.html#cb272-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-11"><a href="analisis-intervensi-pada-model-arima.html#cb272-11" aria-hidden="true" tabindex="-1"></a>modfin.ukr<span class="ot">&lt;-</span><span class="fu">Arima</span>(crude.ukr<span class="sc">$</span>Close,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb272-12"><a href="analisis-intervensi-pada-model-arima.html#cb272-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">xreg=</span><span class="fu">cbind</span>(covreg,URReg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">270</span>,])</span>
<span id="cb272-13"><a href="analisis-intervensi-pada-model-arima.html#cb272-13" aria-hidden="true" tabindex="-1"></a>modfin.ukr</span></code></pre></div>
<pre><code>## Series: crude.ukr$Close 
## Regression with ARIMA(1,1,0) errors 
## 
## Coefficients:
##          ar1  covreg   URReg
##       0.1965  0.9999  1.0000
## s.e.  0.0598  0.1680  0.1031
## 
## sigma^2 = 6.187:  log likelihood = -622.99
## AIC=1253.97   AICc=1254.13   BIC=1268.34</code></pre>
<p>Koefisien regressor mendekati 1 - ini adalah pertanda yang baik.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="analisis-intervensi-pada-model-arima.html#cb274-1" aria-hidden="true" tabindex="-1"></a>forc.inv.ukr<span class="ot">&lt;-</span><span class="fu">forecast</span>(modfin.ukr,<span class="dv">8</span>,<span class="at">xreg=</span><span class="fu">cbind</span>(covreg,URReg)[<span class="dv">271</span><span class="sc">:</span><span class="dv">278</span>,])</span>
<span id="cb274-2"><a href="analisis-intervensi-pada-model-arima.html#cb274-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-3"><a href="analisis-intervensi-pada-model-arima.html#cb274-3" aria-hidden="true" tabindex="-1"></a>weeklyCrude[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="st">&quot;fitted.intvrev&quot;</span><span class="ot">=</span><span class="fu">c</span>(forc.inv.ukr<span class="sc">$</span>fitted,<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">8</span>)),  </span>
<span id="cb274-4"><a href="analisis-intervensi-pada-model-arima.html#cb274-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;predicted.intvrev&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">270</span>),forc.inv.ukr<span class="sc">$</span>mean),</span>
<span id="cb274-5"><a href="analisis-intervensi-pada-model-arima.html#cb274-5" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;lwr.intvrev&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">270</span>),forc.inv.ukr<span class="sc">$</span>lower[,<span class="dv">2</span>]),</span>
<span id="cb274-6"><a href="analisis-intervensi-pada-model-arima.html#cb274-6" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;upr.intvrev&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">270</span>),forc.inv.ukr<span class="sc">$</span>upper[,<span class="dv">2</span>]))]</span>
<span id="cb274-7"><a href="analisis-intervensi-pada-model-arima.html#cb274-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb274-8"><a href="analisis-intervensi-pada-model-arima.html#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>Date,<span class="at">y=</span>Close),<span class="at">data=</span>weeklyCrude[<span class="dv">260</span><span class="sc">:</span><span class="dv">278</span>])<span class="sc">+</span></span>
<span id="cb274-9"><a href="analisis-intervensi-pada-model-arima.html#cb274-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.3</span>, <span class="at">color=</span><span class="st">&quot;darkgray&quot;</span>)<span class="sc">+</span></span>
<span id="cb274-10"><a href="analisis-intervensi-pada-model-arima.html#cb274-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>fitted.intvrev,<span class="at">color=</span><span class="st">&quot;Fitted&quot;</span>))<span class="sc">+</span></span>
<span id="cb274-11"><a href="analisis-intervensi-pada-model-arima.html#cb274-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.def,<span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>), <span class="at">size=</span><span class="dv">3</span>, <span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb274-12"><a href="analisis-intervensi-pada-model-arima.html#cb274-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.def,<span class="at">ymax=</span>upr.def, <span class="at">color=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>, </span>
<span id="cb274-13"><a href="analisis-intervensi-pada-model-arima.html#cb274-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Tanpa Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb274-14"><a href="analisis-intervensi-pada-model-arima.html#cb274-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.intv,<span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">size=</span><span class="dv">3</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb274-15"><a href="analisis-intervensi-pada-model-arima.html#cb274-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.intv,<span class="at">ymax=</span>upr.intv, <span class="at">color=</span><span class="st">&quot;Intervensi&quot;</span>, </span>
<span id="cb274-16"><a href="analisis-intervensi-pada-model-arima.html#cb274-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Intervensi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb274-17"><a href="analisis-intervensi-pada-model-arima.html#cb274-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>predicted.intvrev,<span class="at">color=</span><span class="st">&quot;Revisi&quot;</span>),<span class="at">size=</span><span class="dv">3</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb274-18"><a href="analisis-intervensi-pada-model-arima.html#cb274-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>lwr.intvrev,<span class="at">ymax=</span>upr.intvrev, <span class="at">color=</span><span class="st">&quot;Revisi&quot;</span>, </span>
<span id="cb274-19"><a href="analisis-intervensi-pada-model-arima.html#cb274-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">fill=</span><span class="st">&quot;Revisi&quot;</span>),<span class="at">alpha=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb274-20"><a href="analisis-intervensi-pada-model-arima.html#cb274-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb274-21"><a href="analisis-intervensi-pada-model-arima.html#cb274-21" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, </span>
<span id="cb274-22"><a href="analisis-intervensi-pada-model-arima.html#cb274-22" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span>, <span class="st">&#39;Revisi&#39;</span> ),</span>
<span id="cb274-23"><a href="analisis-intervensi-pada-model-arima.html#cb274-23" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb274-24"><a href="analisis-intervensi-pada-model-arima.html#cb274-24" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb274-25"><a href="analisis-intervensi-pada-model-arima.html#cb274-25" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span>,</span>
<span id="cb274-26"><a href="analisis-intervensi-pada-model-arima.html#cb274-26" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Revisi&#39;</span> <span class="ot">=</span> <span class="st">&#39;#56B4E9&#39;</span>))<span class="sc">+</span></span>
<span id="cb274-27"><a href="analisis-intervensi-pada-model-arima.html#cb274-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">name=</span><span class="st">&#39;Prediksi ARIMA&#39;</span>,</span>
<span id="cb274-28"><a href="analisis-intervensi-pada-model-arima.html#cb274-28" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span>, <span class="st">&#39;Tanpa Intervensi&#39;</span>, </span>
<span id="cb274-29"><a href="analisis-intervensi-pada-model-arima.html#cb274-29" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span>, <span class="st">&#39;Revisi&#39;</span> ),</span>
<span id="cb274-30"><a href="analisis-intervensi-pada-model-arima.html#cb274-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values=</span><span class="fu">c</span>(<span class="st">&#39;Fitted&#39;</span><span class="ot">=</span><span class="st">&#39;black&#39;</span>, </span>
<span id="cb274-31"><a href="analisis-intervensi-pada-model-arima.html#cb274-31" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Tanpa Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#DB0000&#39;</span>, </span>
<span id="cb274-32"><a href="analisis-intervensi-pada-model-arima.html#cb274-32" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Intervensi&#39;</span><span class="ot">=</span><span class="st">&#39;#E69F00&#39;</span>,</span>
<span id="cb274-33"><a href="analisis-intervensi-pada-model-arima.html#cb274-33" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Revisi&#39;</span> <span class="ot">=</span> <span class="st">&#39;#56B4E9&#39;</span>))<span class="sc">+</span></span>
<span id="cb274-34"><a href="analisis-intervensi-pada-model-arima.html#cb274-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot; &quot;</span>)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">&quot; Perbandingan Model Intervensi dan non-Intervensi terbaik&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 8 row(s) containing missing values (geom_path).</code></pre>
<pre><code>## Warning: Removed 12 rows containing missing values (geom_point).
## Removed 12 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 11 rows containing missing values (geom_point).</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-542-1.png" width="672" /></p>
<p>Model intervensi menduga harga minyak lebih rendah daripada model tanpa intervensi, baik yang telah direvisi atau tidak. Namun, tidak terlihat jelas mana model yang lebih baik. Bandingkan nilai akurasi:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="analisis-intervensi-pada-model-arima.html#cb278-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close,</span>
<span id="cb278-2"><a href="analisis-intervensi-pada-model-arima.html#cb278-2" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.def),</span>
<span id="cb278-3"><a href="analisis-intervensi-pada-model-arima.html#cb278-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close,</span>
<span id="cb278-4"><a href="analisis-intervensi-pada-model-arima.html#cb278-4" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.intv),</span>
<span id="cb278-5"><a href="analisis-intervensi-pada-model-arima.html#cb278-5" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close,</span>
<span id="cb278-6"><a href="analisis-intervensi-pada-model-arima.html#cb278-6" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.intvrev))</span>
<span id="cb278-7"><a href="analisis-intervensi-pada-model-arima.html#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>,<span class="st">&quot;Revisi&quot;</span>)</span>
<span id="cb278-8"><a href="analisis-intervensi-pada-model-arima.html#cb278-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-9"><a href="analisis-intervensi-pada-model-arima.html#cb278-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb278-10"><a href="analisis-intervensi-pada-model-arima.html#cb278-10" aria-hidden="true" tabindex="-1"></a>        compAcc,</span>
<span id="cb278-11"><a href="analisis-intervensi-pada-model-arima.html#cb278-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>T,</span>
<span id="cb278-12"><a href="analisis-intervensi-pada-model-arima.html#cb278-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span><span class="dv">4</span></span>
<span id="cb278-13"><a href="analisis-intervensi-pada-model-arima.html#cb278-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">17.3866</td>
<td align="right">18.1892</td>
<td align="right">17.3866</td>
<td align="right">14.3930</td>
<td align="right">14.3930</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">-11.6907</td>
<td align="right">12.8181</td>
<td align="right">11.6907</td>
<td align="right">-12.7498</td>
<td align="right">12.7498</td>
</tr>
<tr class="odd">
<td align="left">Revisi</td>
<td align="right">-12.4107</td>
<td align="right">13.4935</td>
<td align="right">12.4107</td>
<td align="right">-13.5316</td>
<td align="right">13.5316</td>
</tr>
</tbody>
</table>
<p>Namun, di jangka waktu pendek model tanpa intervensi lebih baik ramalannya menurut MAPE. Model revisi memiliki ramalan terburuk.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="analisis-intervensi-pada-model-arima.html#cb279-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>],</span>
<span id="cb279-2"><a href="analisis-intervensi-pada-model-arima.html#cb279-2" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.def[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>]),</span>
<span id="cb279-3"><a href="analisis-intervensi-pada-model-arima.html#cb279-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>],</span>
<span id="cb279-4"><a href="analisis-intervensi-pada-model-arima.html#cb279-4" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.intv[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>]),</span>
<span id="cb279-5"><a href="analisis-intervensi-pada-model-arima.html#cb279-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">accuracy</span>(weeklyCrude<span class="sc">$</span>Close[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>],</span>
<span id="cb279-6"><a href="analisis-intervensi-pada-model-arima.html#cb279-6" aria-hidden="true" tabindex="-1"></a>                        weeklyCrude<span class="sc">$</span>predicted.intvrev[<span class="dv">271</span><span class="sc">:</span><span class="dv">274</span>]))</span>
<span id="cb279-7"><a href="analisis-intervensi-pada-model-arima.html#cb279-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>, <span class="st">&quot;Revisi&quot;</span>)</span>
<span id="cb279-8"><a href="analisis-intervensi-pada-model-arima.html#cb279-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-9"><a href="analisis-intervensi-pada-model-arima.html#cb279-9" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb279-10"><a href="analisis-intervensi-pada-model-arima.html#cb279-10" aria-hidden="true" tabindex="-1"></a>        compAcc,</span>
<span id="cb279-11"><a href="analisis-intervensi-pada-model-arima.html#cb279-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>T,</span>
<span id="cb279-12"><a href="analisis-intervensi-pada-model-arima.html#cb279-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span><span class="dv">4</span></span>
<span id="cb279-13"><a href="analisis-intervensi-pada-model-arima.html#cb279-13" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">14.5981</td>
<td align="right">15.8018</td>
<td align="right">14.5981</td>
<td align="right">12.1083</td>
<td align="right">12.1083</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">-14.2638</td>
<td align="right">15.4893</td>
<td align="right">14.2638</td>
<td align="right">-15.5560</td>
<td align="right">15.5560</td>
</tr>
<tr class="odd">
<td align="left">Revisi</td>
<td align="right">-15.0840</td>
<td align="right">16.0316</td>
<td align="right">15.0840</td>
<td align="right">-16.4465</td>
<td align="right">16.4465</td>
</tr>
</tbody>
</table>
<p>Model intervensi memiliki MAE dan RMSE lebih rendah, tapi MAPE lebih tinggi. MAPE memberikan penalti lebih besar pada error yang negatif <span class="citation">(<a href="#ref-fpp3" role="doc-biblioref">Hyndman dan Athanasopoulos 2021</a>)</span>, sehingga dalam kasus ini MAE dan RMSE lebih dapat dipercaya - model intervensi baik. Ini juga terlihat di training:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="analisis-intervensi-pada-model-arima.html#cb280-1" aria-hidden="true" tabindex="-1"></a>compAcc<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">accuracy</span>(model1.crude2),</span>
<span id="cb280-2"><a href="analisis-intervensi-pada-model-arima.html#cb280-2" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(intvmodukr),</span>
<span id="cb280-3"><a href="analisis-intervensi-pada-model-arima.html#cb280-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">accuracy</span>(intvmod.noautocor))</span>
<span id="cb280-4"><a href="analisis-intervensi-pada-model-arima.html#cb280-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(compAcc)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;Tanpa Intervensi&quot;</span>,<span class="st">&quot;Intervensi&quot;</span>,<span class="st">&quot;Revisi&quot;</span>)</span>
<span id="cb280-5"><a href="analisis-intervensi-pada-model-arima.html#cb280-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-6"><a href="analisis-intervensi-pada-model-arima.html#cb280-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb280-7"><a href="analisis-intervensi-pada-model-arima.html#cb280-7" aria-hidden="true" tabindex="-1"></a>        compAcc,</span>
<span id="cb280-8"><a href="analisis-intervensi-pada-model-arima.html#cb280-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>T,</span>
<span id="cb280-9"><a href="analisis-intervensi-pada-model-arima.html#cb280-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">digits =</span><span class="dv">4</span></span>
<span id="cb280-10"><a href="analisis-intervensi-pada-model-arima.html#cb280-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ME</th>
<th align="right">RMSE</th>
<th align="right">MAE</th>
<th align="right">MPE</th>
<th align="right">MAPE</th>
<th align="right">MASE</th>
<th align="right">ACF1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tanpa Intervensi</td>
<td align="right">0.2038</td>
<td align="right">3.0027</td>
<td align="right">2.0795</td>
<td align="right">0.1035</td>
<td align="right">4.0328</td>
<td align="right">0.9848</td>
<td align="right">-0.0022</td>
</tr>
<tr class="even">
<td align="left">Intervensi</td>
<td align="right">0.1278</td>
<td align="right">2.4784</td>
<td align="right">1.9133</td>
<td align="right">-0.0426</td>
<td align="right">3.7524</td>
<td align="right">0.9061</td>
<td align="right">-0.0051</td>
</tr>
<tr class="odd">
<td align="left">Revisi</td>
<td align="right">0.1146</td>
<td align="right">2.4820</td>
<td align="right">1.9502</td>
<td align="right">0.0071</td>
<td align="right">3.7983</td>
<td align="right">0.9236</td>
<td align="right">-0.0183</td>
</tr>
</tbody>
</table>
<p>Akurasi model revisi lebih baik dari intervensi.</p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-cryer_time_2008" class="csl-entry">
Cryer JD, Chan KS. 2008. <em>Time <span>Series</span> <span>Analysis</span>: <span>With</span> <span>Applications</span> in <span>R</span></em>. Springer New York. (Springer <span>Texts</span> in <span>Statistics</span>).
</div>
<div id="ref-fpp3" class="csl-entry">
Hyndman RJ, Athanasopoulos G. 2021. <em>Forecasting: Principles and Practice</em>. ed ke-3. Australia: OTexts.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="optimisasi-parameter-pemulusan-dengan-validasi-silang.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-pemodelan.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
